{"ast":null,"code":"var _jsxFileName = \"C:\\\\aria\\\\cicc-app\\\\front-end\\\\src\\\\components\\\\tags\\\\TagsInput.js\",\n    _s = $RefreshSig$();\n\nimport React from \"react\";\nimport { InputGroup, Input, DropdownToggle, DropdownMenu, DropdownItem, Button, UncontrolledButtonDropdown } from \"reactstrap\";\nimport { v4 } from 'uuid';\nimport { RiDeleteBin2Fill } from \"react-icons/ri\";\nimport { isAdmin } from 'common/SessionUtils';\nimport Tag from \"components/tags/Tag\";\nimport { mountQueryFromTags } from \"axios/AxiosUtils\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst smScreenSize = 640;\nexport default function TagsInput(props) {\n  _s();\n\n  const [internalTags, setInternalTags] = React.useState({});\n  const [isInterval, setIsInterval] = React.useState(false);\n  const [input, setInput] = React.useState(\"\");\n  const [intervalInput, setIntervalInput] = React.useState(\"\");\n  const [columnIndex, setColumn] = React.useState(-1);\n  const [errorCode, setErrorCode] = React.useState(-1);\n  const [isDesktop, setDesktop] = React.useState(window.innerWidth > smScreenSize);\n  const [tags, setTags] = props.tagsState || [internalTags, setInternalTags];\n  const columns = props.columns || {};\n  const columnsNames = Object.keys(columns).filter(columnName => props.columns[columnName].adminOnly ? isAdmin() : true);\n\n  const setQuery = props.setQuery || (() => {});\n\n  const defaultText = props.defaultText || isDesktop ? \"Selecione\" : \"\";\n  const errors = [\"Valor já inserido!\", \"Campo vazio! Insira algum valor.\", \"Formato inválido!\"];\n\n  const updateMedia = () => {\n    setDesktop(window.innerWidth > smScreenSize);\n  };\n\n  const clearInputs = () => {\n    setInput(\"\");\n    setIntervalInput(\"\");\n    setIsInterval(false);\n    setErrorCode(-1);\n  };\n\n  const selectColumn = () => columnIndex > -1 ? columnsNames[columnIndex] : defaultText;\n\n  const removeTags = (column, indexToRemove) => {\n    const updatedTags = { ...tags,\n      [column]: tags[column].filter((_, index) => index !== indexToRemove)\n    };\n    setTags(updatedTags);\n    setQuery(mountQueryFromTags(updatedTags, columns));\n  };\n\n  const validate = (value, currentColumn) => {\n    if (!value) {\n      setErrorCode(1);\n      return false;\n    }\n\n    if (columns[currentColumn].regex && !columns[currentColumn].regex.test(value)) {\n      setErrorCode(2);\n      return false;\n    }\n\n    return true;\n  };\n\n  const addTags = () => {\n    const currentColumn = columnsNames[columnIndex];\n    if (!validate(input.trim(), currentColumn) || isInterval && !validate(intervalInput.trim(), currentColumn)) return;\n    const columnFilters = tags[currentColumn] || [];\n    const mask = columns[currentColumn].mask ? columns[currentColumn].mask.encode : v => v;\n    const filter = isInterval ? [mask(input.trim()), mask(intervalInput.trim())] : mask(input.trim());\n\n    if (columnFilters.includes(filter)) {\n      setErrorCode(0);\n      return;\n    }\n\n    const updatedTags = { ...tags,\n      [currentColumn]: [...columnFilters, filter]\n    };\n    clearInputs();\n    setColumn(-1);\n    setTags(updatedTags);\n    setQuery(mountQueryFromTags(updatedTags, columns));\n  };\n\n  const validateAndUpdate = (e, filter, setter) => filter.alwaysValidate ? filter.regex.test(e.target.value) && setter(e.target.value) : setter(e.target.value);\n\n  React.useEffect(() => {\n    window.addEventListener(\"resize\", updateMedia);\n    return () => window.removeEventListener(\"resize\", updateMedia);\n  });\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: props.size === \"lg\" ? \"tags-input-lg\" : \"tags-input\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"input-row\",\n      children: [/*#__PURE__*/_jsxDEV(InputGroup, {\n        className: \"tags-input-group\",\n        children: [/*#__PURE__*/_jsxDEV(UncontrolledButtonDropdown, {\n          style: {\n            borderRadius: \"4px 0px 0px 4px\"\n          },\n          children: [/*#__PURE__*/_jsxDEV(DropdownToggle, {\n            caret: true,\n            color: \"primary\",\n            style: {\n              borderRadius: \"4px 0px 0px 4px\"\n            },\n            children: selectColumn()\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 101,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(DropdownMenu, {\n            children: columnsNames.map((columnName, index) => {\n              return columnName.includes('BLANK') ? /*#__PURE__*/_jsxDEV(DropdownItem, {\n                divider: true\n              }, v4(), false, {\n                fileName: _jsxFileName,\n                lineNumber: 108,\n                columnNumber: 11\n              }, this) : /*#__PURE__*/_jsxDEV(DropdownItem, {\n                onClick: () => {\n                  clearInputs();\n                  setColumn(index);\n                },\n                children: columnName\n              }, index, false, {\n                fileName: _jsxFileName,\n                lineNumber: 110,\n                columnNumber: 11\n              }, this);\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 104,\n            columnNumber: 7\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(Input, {\n          value: input,\n          type: columnIndex > -1 ? columns[columnsNames[columnIndex]].inputType : \"text\",\n          invalid: errorCode > -1,\n          disabled: columnIndex === -1,\n          onChange: event => validateAndUpdate(event, columns[columnsNames[columnIndex]], setInput),\n          onKeyUp: event => event.key === \"Enter\" && addTags(),\n          placeholder: \"Digite o filtro\",\n          style: {\n            borderRadius: \"0px\"\n          },\n          step: 1,\n          children: columnIndex > -1 && columns[columnsNames[columnIndex]].dropdown ? /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(\"option\", {}, \"0_select\", false, {\n              fileName: _jsxFileName,\n              lineNumber: 131,\n              columnNumber: 9\n            }, this), Object.keys(columns[columnsNames[columnIndex]].dropdown).map(key => {\n              if (columns[columnsNames[columnIndex]].dropdown[key].adminOnly && !isAdmin()) return \"\";\n              return /*#__PURE__*/_jsxDEV(\"option\", {\n                value: key,\n                children: key\n              }, \"0_\".concat(key), false, {\n                fileName: _jsxFileName,\n                lineNumber: 136,\n                columnNumber: 11\n              }, this);\n            })]\n          }, void 0, true) : null\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 6\n        }, this), columnIndex > -1 && !isInterval && columns[columnsNames[columnIndex]].supportsInterval && /*#__PURE__*/_jsxDEV(Button, {\n          style: {\n            borderRadius: \"0px\"\n          },\n          onClick: () => setIsInterval(true),\n          children: \"+ Intervalo\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 7\n        }, this), isInterval && /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(Input, {\n            value: intervalInput,\n            type: columns[columnsNames[columnIndex]].inputType,\n            invalid: errorCode > -1,\n            onChange: event => validateAndUpdate(event, columns[columnsNames[columnIndex]], setIntervalInput),\n            onKeyUp: event => event.key === \"Enter\" && addTags(),\n            placeholder: \"Digite o filtro\",\n            style: {\n              borderRadius: \"0px\"\n            },\n            step: 1,\n            children: columns[columnsNames[columnIndex]].dropdown && /*#__PURE__*/_jsxDEV(_Fragment, {\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {}, \"1_select\", false, {\n                fileName: _jsxFileName,\n                lineNumber: 169,\n                columnNumber: 11\n              }, this), Object.keys(columns[columnsNames[columnIndex]].dropdown).map(key => {\n                return /*#__PURE__*/_jsxDEV(\"option\", {\n                  value: key,\n                  children: key\n                }, \"1_\".concat(key), false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 172,\n                  columnNumber: 13\n                }, this);\n              })]\n            }, void 0, true)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 157,\n            columnNumber: 8\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            style: {\n              borderRadius: 0,\n              padding: \"0px 12px\"\n            },\n            onClick: () => {\n              setIsInterval(false);\n            },\n            children: /*#__PURE__*/_jsxDEV(RiDeleteBin2Fill, {\n              fontSize: 18\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 182,\n              columnNumber: 9\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 178,\n            columnNumber: 8\n          }, this)]\n        }, void 0, true), /*#__PURE__*/_jsxDEV(Button, {\n          color: \"primary\",\n          disabled: columnIndex === -1,\n          style: {\n            borderRadius: \"0px 4px 4px 0px\",\n            fontSize: 18,\n            padding: \"0px 24px\"\n          },\n          onClick: () => addTags(),\n          children: \"+\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 187,\n          columnNumber: 6\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 5\n      }, this), props.children]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [errorCode > -1 && /*#__PURE__*/_jsxDEV(\"span\", {\n        style: {\n          color: \"red\"\n        },\n        children: errors[errorCode]\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 24\n      }, this), Object.keys(tags).filter(columnName => tags[columnName].length > 0).length > 0 && /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 200,\n        columnNumber: 88\n      }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n        id: \"tags\",\n        style: {\n          padding: '0px',\n          marginTop: \"1rem\"\n        },\n        children: Object.keys(tags).filter(columnName => tags[columnName].length > 0).map(columnName => /*#__PURE__*/_jsxDEV(\"li\", {\n          style: {\n            display: \"inline-block\",\n            paddingRight: \"20px\"\n          },\n          children: /*#__PURE__*/_jsxDEV(Tag, {\n            column: columnName,\n            filters: tags[columnName],\n            close: removeTags\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 206,\n            columnNumber: 9\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 205,\n          columnNumber: 8\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 202,\n        columnNumber: 5\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 4\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 97,\n    columnNumber: 3\n  }, this);\n}\n\n_s(TagsInput, \"ZGaZKg0wxJG18Q5oqxT1xJQiDQw=\");\n\n_c = TagsInput;\n;\n\nvar _c;\n\n$RefreshReg$(_c, \"TagsInput\");","map":{"version":3,"sources":["C:/aria/cicc-app/front-end/src/components/tags/TagsInput.js"],"names":["React","InputGroup","Input","DropdownToggle","DropdownMenu","DropdownItem","Button","UncontrolledButtonDropdown","v4","RiDeleteBin2Fill","isAdmin","Tag","mountQueryFromTags","smScreenSize","TagsInput","props","internalTags","setInternalTags","useState","isInterval","setIsInterval","input","setInput","intervalInput","setIntervalInput","columnIndex","setColumn","errorCode","setErrorCode","isDesktop","setDesktop","window","innerWidth","tags","setTags","tagsState","columns","columnsNames","Object","keys","filter","columnName","adminOnly","setQuery","defaultText","errors","updateMedia","clearInputs","selectColumn","removeTags","column","indexToRemove","updatedTags","_","index","validate","value","currentColumn","regex","test","addTags","trim","columnFilters","mask","encode","v","includes","validateAndUpdate","e","setter","alwaysValidate","target","useEffect","addEventListener","removeEventListener","size","borderRadius","map","inputType","event","key","dropdown","supportsInterval","padding","fontSize","children","color","length","marginTop","display","paddingRight"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport {\r\n\tInputGroup,\r\n\tInput,\r\n\tDropdownToggle,\r\n\tDropdownMenu,\r\n\tDropdownItem,\r\n\tButton,\r\n\tUncontrolledButtonDropdown\r\n} from \"reactstrap\";\r\nimport { v4 } from 'uuid'\r\nimport { RiDeleteBin2Fill } from \"react-icons/ri\"\r\n\r\nimport { isAdmin } from 'common/SessionUtils'\r\nimport Tag from \"components/tags/Tag\"\r\nimport { mountQueryFromTags } from \"axios/AxiosUtils\";\r\n\r\nconst smScreenSize = 640\r\n\r\nexport default function TagsInput(props) {\r\n\tconst [internalTags, setInternalTags] = React.useState({})\r\n\tconst [isInterval, setIsInterval] = React.useState(false)\r\n\tconst [input, setInput] = React.useState(\"\")\r\n\tconst [intervalInput, setIntervalInput] = React.useState(\"\")\r\n\tconst [columnIndex, setColumn] = React.useState(-1)\r\n\tconst [errorCode, setErrorCode] = React.useState(-1)\r\n\tconst [isDesktop, setDesktop] = React.useState(window.innerWidth > smScreenSize)\r\n\r\n\tconst [tags, setTags] = props.tagsState || [internalTags, setInternalTags]\r\n\tconst columns = props.columns || {}\r\n\tconst columnsNames = Object.keys(columns).filter(columnName => props.columns[columnName].adminOnly ? isAdmin() : true)\r\n\tconst setQuery = props.setQuery || (() => { })\r\n\tconst defaultText = props.defaultText ||  isDesktop? \"Selecione\" : \"\"\r\n\tconst errors = [\"Valor já inserido!\", \"Campo vazio! Insira algum valor.\", \"Formato inválido!\"]\r\n\r\n\r\n  const updateMedia = () => { setDesktop(window.innerWidth > smScreenSize) }\r\n\r\n\r\n\tconst clearInputs = () => {\r\n\t\tsetInput(\"\")\r\n\t\tsetIntervalInput(\"\")\r\n\t\tsetIsInterval(false)\r\n\t\tsetErrorCode(-1)\r\n\t}\r\n\r\n\tconst selectColumn = () => columnIndex > -1 ? columnsNames[columnIndex] : defaultText\r\n\r\n\tconst removeTags = (column, indexToRemove) => {\r\n\t\tconst updatedTags = { ...tags, [column]: tags[column].filter((_, index) => index !== indexToRemove) }\r\n\t\tsetTags(updatedTags)\r\n\t\tsetQuery(mountQueryFromTags(updatedTags, columns))\r\n\t}\r\n\r\n\tconst validate = (value, currentColumn) => {\r\n\t\tif (!value) {\r\n\t\t\tsetErrorCode(1)\r\n\t\t\treturn false\r\n\t\t}\r\n\t\tif (columns[currentColumn].regex && !columns[currentColumn].regex.test(value)) {\r\n\t\t\tsetErrorCode(2)\r\n\t\t\treturn false\r\n\t\t}\r\n\t\treturn true\r\n\t}\r\n\r\n\tconst addTags = () => {\r\n\t\tconst currentColumn = columnsNames[columnIndex]\r\n\t\tif (!validate(input.trim(), currentColumn) || (isInterval && !validate(intervalInput.trim(), currentColumn)))\r\n\t\t\treturn\r\n\r\n\t\tconst columnFilters = tags[currentColumn] || []\r\n\t\tconst mask = columns[currentColumn].mask ? columns[currentColumn].mask.encode : (v => v)\r\n\t\tconst filter = isInterval ? [mask(input.trim()), mask(intervalInput.trim())] : mask(input.trim())\r\n\t\tif (columnFilters.includes(filter)) {\r\n\t\t\tsetErrorCode(0)\r\n\t\t\treturn\r\n\t\t}\r\n\t\tconst updatedTags = { ...tags, [currentColumn]: [...columnFilters, filter] }\r\n\r\n\t\tclearInputs()\r\n\t\tsetColumn(-1)\r\n\t\tsetTags(updatedTags)\r\n\t\tsetQuery(mountQueryFromTags(updatedTags, columns))\r\n\t}\r\n\r\n\tconst validateAndUpdate = (e, filter, setter) => (\r\n\t\tfilter.alwaysValidate? filter.regex.test(e.target.value) && setter(e.target.value): setter(e.target.value)\r\n\t)\r\n\r\n\tReact.useEffect(() => {\r\n    window.addEventListener(\"resize\", updateMedia);\r\n    return () => window.removeEventListener(\"resize\", updateMedia);\r\n  })\r\n\r\n\treturn (\r\n\t\t<div className={props.size === \"lg\"? \"tags-input-lg\":\"tags-input\"}>\r\n\t\t\t<div className=\"input-row\">\r\n\t\t\t\t<InputGroup className=\"tags-input-group\">\r\n\t\t\t\t\t<UncontrolledButtonDropdown style={{ borderRadius: \"4px 0px 0px 4px\" }}>\r\n\t\t\t\t\t\t<DropdownToggle caret color=\"primary\" style={{ borderRadius: \"4px 0px 0px 4px\" }}>\r\n\t\t\t\t\t\t\t{selectColumn()}\r\n\t\t\t\t\t\t</DropdownToggle>\r\n\t\t\t\t\t\t<DropdownMenu>\r\n\t\t\t\t\t\t\t{columnsNames.map((columnName, index) => {\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t(columnName.includes('BLANK')) ?\r\n\t\t\t\t\t\t\t\t\t\t<DropdownItem key={v4()}  divider />\r\n\t\t\t\t\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\t\t\t\t<DropdownItem key={index} onClick={() => { clearInputs(); setColumn(index) }}>\r\n\t\t\t\t\t\t\t\t\t\t\t{columnName}\r\n\t\t\t\t\t\t\t\t\t\t</DropdownItem>\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t</DropdownMenu>\r\n\t\t\t\t\t</UncontrolledButtonDropdown>\r\n\r\n\t\t\t\t\t<Input\r\n\t\t\t\t\t\tvalue={input}\r\n\t\t\t\t\t\ttype={(columnIndex > -1) ? columns[columnsNames[columnIndex]].inputType : \"text\"}\r\n\t\t\t\t\t\tinvalid={errorCode > -1}\r\n\t\t\t\t\t\tdisabled={columnIndex === -1}\r\n\t\t\t\t\t\tonChange={event => validateAndUpdate(event, columns[columnsNames[columnIndex]], setInput)}\r\n\t\t\t\t\t\tonKeyUp={event => event.key === \"Enter\" && addTags()}\r\n\t\t\t\t\t\tplaceholder=\"Digite o filtro\"\r\n\t\t\t\t\t\tstyle={{ borderRadius: \"0px\" }}\r\n\t\t\t\t\t\tstep={1}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{(columnIndex > -1 && columns[columnsNames[columnIndex]].dropdown) ?\r\n\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t<option key=\"0_select\" />\r\n\t\t\t\t\t\t\t\t{Object.keys(columns[columnsNames[columnIndex]].dropdown).map((key) => {\r\n\t\t\t\t\t\t\t\t\tif (columns[columnsNames[columnIndex]].dropdown[key].adminOnly && !isAdmin())\r\n\t\t\t\t\t\t\t\t\t\treturn \"\"\r\n\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t<option value={key} key={`0_${key}`}>{key}</option>\r\n\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\tnull\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</Input>\r\n\r\n\t\t\t\t\t{(columnIndex > -1 && !isInterval && columns[columnsNames[columnIndex]].supportsInterval) &&\r\n\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\tstyle={{ borderRadius: \"0px\" }}\r\n\t\t\t\t\t\t\tonClick={() => setIsInterval(true)}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t+ Intervalo\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\t{isInterval &&\r\n\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t<Input\r\n\t\t\t\t\t\t\t\tvalue={intervalInput}\r\n\t\t\t\t\t\t\t\ttype={columns[columnsNames[columnIndex]].inputType}\r\n\t\t\t\t\t\t\t\tinvalid={errorCode > -1}\r\n\t\t\t\t\t\t\t\tonChange={event => validateAndUpdate(event, columns[columnsNames[columnIndex]], setIntervalInput)}\r\n\t\t\t\t\t\t\t\tonKeyUp={event => event.key === \"Enter\" && addTags()}\r\n\t\t\t\t\t\t\t\tplaceholder=\"Digite o filtro\"\r\n\t\t\t\t\t\t\t\tstyle={{ borderRadius: \"0px\" }}\r\n\t\t\t\t\t\t\t\tstep={1}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{columns[columnsNames[columnIndex]].dropdown &&\r\n\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t<option key=\"1_select\"/>\r\n\t\t\t\t\t\t\t\t\t\t{Object.keys(columns[columnsNames[columnIndex]].dropdown).map((key) => {\r\n\t\t\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<option value={key} key={`1_${key}`}>{key}</option>\r\n\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t</Input>\r\n\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\tstyle={{ borderRadius: 0, padding: \"0px 12px\" }}\r\n\t\t\t\t\t\t\t\tonClick={() => { setIsInterval(false) }}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<RiDeleteBin2Fill fontSize={18} />\r\n\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t</>\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tcolor=\"primary\"\r\n\t\t\t\t\t\tdisabled={columnIndex === -1}\r\n\t\t\t\t\t\tstyle={{ borderRadius: \"0px 4px 4px 0px\", fontSize: 18, padding: \"0px 24px\" }}\r\n\t\t\t\t\t\tonClick={() => addTags()}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t+\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</InputGroup>\r\n\t\t\t\t{props.children}\t\t\t\t\r\n\t\t\t</div>\r\n\t\t\t<div>\r\n\t\t\t\t{errorCode > -1 && <span style={{ color: \"red\" }}>{errors[errorCode]}</span>}\r\n\t\t\t\t{Object.keys(tags).filter(columnName => tags[columnName].length > 0).length > 0 && <hr />}\r\n\t\t\t\t\r\n\t\t\t\t<ul id=\"tags\" style={{ padding: '0px', marginTop: \"1rem\" }}>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tObject.keys(tags).filter(columnName => tags[columnName].length > 0).map(columnName => (\r\n\t\t\t\t\t\t\t<li style={{ display: \"inline-block\", paddingRight: \"20px\" }}>\r\n\t\t\t\t\t\t\t\t<Tag column={columnName} filters={tags[columnName]} close={removeTags} />\r\n\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t))\r\n\t\t\t\t\t}\r\n\t\t\t\t</ul>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};"]},"metadata":{},"sourceType":"module"}