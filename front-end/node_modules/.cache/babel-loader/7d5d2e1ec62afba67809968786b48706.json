{"ast":null,"code":"import { isFiscalActionDone } from \"common/enumerators/NotificationStatus\";\nimport { HOMOLOGATION_DATE } from \"common/model/Notification\";\nimport { FISCAL_ACTION_REPORT_AUDITOR } from \"common/model/Notification\";\nimport { DESIGNATION_AUDITOR } from \"common/model/Notification\";\nimport { FISCAL_NOTIFICATION_LOCK } from \"common/model/Notification\";\nimport { FISCAL_ACTION_AUDITORS } from \"common/model/Notification\";\nimport { SUPERVISION_AUDITOR } from \"common/model/Notification\";\nimport { FISCAL_NOTIFICATION_DATE } from \"common/model/Notification\";\nimport { SUPERVISION_DATE } from \"common/model/Notification\";\nimport { FISCAL_ACTION_REPORT } from \"common/model/Notification\";\nimport { MONITORING_USER_NAME } from \"common/model/Notification\";\nimport { MONITORING_USER_LOGIN } from \"common/model/Notification\";\nimport { REPORT_ENABLED } from \"common/model/Notification\";\nimport { LOG_TIMESTAMP } from \"common/model/Notification\";\nimport { ID } from \"common/model/Notification\";\nimport { MONITORING_USER_REGISTRATION_ID } from \"common/model/Notification\";\nimport { MONITORING_USER_ID } from \"common/model/Notification\";\nimport { HISTORY } from \"common/model/Notification\";\nimport { FISCAL_ACTION_DATE } from \"common/model/Notification\";\nimport { FISCAL_NOTIFICATION_LOCK_TIMESTAMP } from \"common/model/Notification\";\nimport { FISCAL_NOTIFICATION_LOCK_USER } from \"common/model/Notification\";\nimport { HOMOLOGATION_AUDITOR } from \"common/model/Notification\";\nimport { FISCAL_ACTION_REPORT_DATE } from \"common/model/Notification\";\nimport { DESIGNATION_DATE } from \"common/model/Notification\";\nimport { AWARENESS_AUDITOR } from \"common/model/Notification\";\nimport { AWARENESS_DATE } from \"common/model/Notification\";\nimport { FISCAL_NOTIFICATION_STATUS } from \"common/model/Notification\";\nimport { isEmpty } from \"common/utils/collections\";\nimport { convertUtcToBrazilianDate } from \"common/utils/validate\";\n\nconst {\n  getUserLogin\n} = require(\"common/SessionUtils\");\n\nconst {\n  default: NOTIFICATION_STATUS_ENUM\n} = require(\"common/enumerators/NotificationStatus\");\n\nexport const BLANK_FORM_DATA = {\n  [FISCAL_ACTION_AUDITORS]: {},\n  [FISCAL_ACTION_DATE]: \"\",\n  [FISCAL_ACTION_REPORT]: \"\",\n  [FISCAL_ACTION_REPORT_DATE]: \"\",\n  [HISTORY]: \"\",\n  [HOMOLOGATION_AUDITOR]: \"\",\n  [MONITORING_USER_NAME]: '',\n  [MONITORING_USER_ID]: '',\n  [MONITORING_USER_LOGIN]: '',\n  [MONITORING_USER_REGISTRATION_ID]: '',\n  [REPORT_ENABLED]: false\n};\nexport function conditionalHomologationFormat(notification, warningsViewed) {\n  let key = notification[ID].toString();\n  let fiscal_notification_status = notification[FISCAL_NOTIFICATION_STATUS];\n\n  if (fiscal_notification_status > NOTIFICATION_STATUS_ENUM.VISUALIZADA) {\n    let homologationUser = notification.fiscal_action_homologation_auditor;\n    let awarenessUser = notification.fiscal_notification_awareness_auditor;\n\n    if (awarenessUser && awarenessUser === getUserLogin() && !notification.fiscal_notification_awareness_date || homologationUser && homologationUser === getUserLogin() && !notification.fiscal_action_homologation_date) {\n      return {\n        color: \"red\"\n      };\n    }\n  } else if (!Object.keys(warningsViewed).includes(key)) {\n    return {\n      fontWeight: 'bold'\n    };\n  } else {\n    return {};\n  }\n} //TODO usar o objeto para fazer estas comparações\n\nexport function mountWarningHistoryText(warning, data) {\n  let result = [];\n  if (isEmpty(data)) return result;\n  mountWarningHistoryFromLog(data, result);\n  mountBaseNotificationHistory(warning, result);\n  result.unshift(\"\".concat(convertUtcToBrazilianDate(warning[FISCAL_NOTIFICATION_DATE]), \"  -   ALERTA DISPARADO\"));\n  result = result.filter((element, index) => {\n    return result.indexOf(element) === index;\n  });\n  return result.join(\"\\n\");\n}\n\nfunction mountWarningHistoryFromLog(data, historyMessages) {\n  for (let log of data) {\n    let status = log[FISCAL_NOTIFICATION_STATUS];\n\n    if (status === NOTIFICATION_STATUS_ENUM.VISUALIZADA && !log[FISCAL_NOTIFICATION_LOCK_TIMESTAMP]) {\n      historyMessages.push(\"\".concat(convertUtcToBrazilianDate(log[LOG_TIMESTAMP]), \"  -   ALERTA VISUALIZADO POR \").concat(log[DESIGNATION_AUDITOR]));\n    } else if (status === NOTIFICATION_STATUS_ENUM.VISUALIZADA && log[FISCAL_NOTIFICATION_LOCK] === 1) {\n      historyMessages.push(\"\".concat(convertUtcToBrazilianDate(log[LOG_TIMESTAMP]), \"  -   ALERTA BLOQUEADO PARA EDI\\xC7\\xC3O POR \").concat(log[FISCAL_NOTIFICATION_LOCK_USER]));\n    } else if (status === NOTIFICATION_STATUS_ENUM.VISUALIZADA && log[FISCAL_NOTIFICATION_LOCK] === 0) {\n      historyMessages.push(\"\".concat(convertUtcToBrazilianDate(log[LOG_TIMESTAMP]), \"  -   ALERTA DESBLOQUEADO PARA EDI\\xC7\\xC3O\"));\n    } else if (status === NOTIFICATION_STATUS_ENUM.PAUSADO) {\n      historyMessages.push(\"\".concat(convertUtcToBrazilianDate(log[LOG_TIMESTAMP]), \"  -   CONFIGURA\\xC7\\xC3O DE ALERTA PAUSADA POR \").concat(log[FISCAL_NOTIFICATION_LOCK_USER], \" AT\\xC9 \").concat(convertUtcToBrazilianDate(log[FISCAL_NOTIFICATION_LOCK_TIMESTAMP])));\n    } else if (status === NOTIFICATION_STATUS_ENUM.ENCERRADO) {\n      historyMessages.push(\"\".concat(convertUtcToBrazilianDate(log[LOG_TIMESTAMP]), \"  -   CONFIGURA\\xC7\\xC3O DE ALERTA ENCERRADA POR \").concat(log[FISCAL_NOTIFICATION_LOCK_USER], \" \"));\n    }\n  }\n}\n\nfunction mountBaseNotificationHistory(data, historyMessages) {\n  if (isEmpty(data)) return historyMessages;\n  let status = data[FISCAL_NOTIFICATION_STATUS];\n  let commando_fiscal = [NOTIFICATION_STATUS_ENUM.SEM_COMANDO, NOTIFICATION_STATUS_ENUM.SEM_COMANDO_HOMOLOGADA, NOTIFICATION_STATUS_ENUM.EM_MONITORAMENTO];\n\n  if (status === NOTIFICATION_STATUS_ENUM.EM_MONITORAMENTO) {\n    historyMessages.push(\"\".concat(convertUtcToBrazilianDate(data[DESIGNATION_DATE]), \"  -   ALERTA MARCADO COMO \\\"EM MONITORAMENTO\\\" POR \").concat(data[DESIGNATION_AUDITOR], \" \"));\n  }\n\n  if (!isEmpty(data[FISCAL_ACTION_AUDITORS] && !commando_fiscal.includes(status))) {\n    historyMessages.push(\"\".concat(convertUtcToBrazilianDate(data[DESIGNATION_DATE]), \"  -   A\\xC7\\xC3O FISCAL DESIGNADA PARA \").concat(data[FISCAL_ACTION_AUDITORS], \" POR \").concat(data[DESIGNATION_AUDITOR], \" \"));\n  }\n\n  if (status === NOTIFICATION_STATUS_ENUM.SEM_COMANDO) {\n    historyMessages.push(\"\".concat(convertUtcToBrazilianDate(data[DESIGNATION_DATE]), \"  -   SEM COMANDO FISCAL DISPON\\xCDVEL. REPORTADO POR \").concat(data[DESIGNATION_AUDITOR], \" \"));\n  }\n\n  if (!isEmpty(data[AWARENESS_DATE])) {\n    historyMessages.push(\"\".concat(convertUtcToBrazilianDate(data[AWARENESS_DATE]), \"  -   CI\\xCANCIA DECLARADA POR \").concat(data[AWARENESS_AUDITOR]));\n  }\n\n  if (status === NOTIFICATION_STATUS_ENUM.SEM_COMANDO_HOMOLOGADA) {\n    historyMessages.push(\"\".concat(convertUtcToBrazilianDate(data[HOMOLOGATION_DATE]), \"  -   SEM COMANDO FISCAL DISPON\\xCDVEL. HOMOLOGADO POR \").concat(data[HOMOLOGATION_AUDITOR], \" \"));\n  }\n\n  if (isFiscalActionDone(status)) {\n    historyMessages.push(\"\".concat(convertUtcToBrazilianDate(data[FISCAL_ACTION_REPORT_DATE]), \"  -   A\\xC7\\xC3O FISCAL REPORTADA POR \").concat(data[FISCAL_ACTION_REPORT_AUDITOR]));\n  }\n\n  if (!isEmpty(data[SUPERVISION_DATE])) {\n    historyMessages.push(\"\".concat(convertUtcToBrazilianDate(data[SUPERVISION_DATE]), \"  -   SUPERVIS\\xC3O DECLARADA POR \").concat(data[SUPERVISION_AUDITOR]));\n  }\n\n  if (!isEmpty(data[HOMOLOGATION_DATE]) && !commando_fiscal.includes(status)) {\n    historyMessages.push(\"\".concat(convertUtcToBrazilianDate(data[HOMOLOGATION_DATE]), \"  -   A\\xC7\\xC3O FISCAL HOMOLOGADA POR \").concat(data[HOMOLOGATION_AUDITOR]));\n  }\n}","map":{"version":3,"sources":["C:/Users/rodri/OneDrive/Documentos/cicc-app/front-end/src/views/Notification/utils/format-data.js"],"names":["isFiscalActionDone","HOMOLOGATION_DATE","FISCAL_ACTION_REPORT_AUDITOR","DESIGNATION_AUDITOR","FISCAL_NOTIFICATION_LOCK","FISCAL_ACTION_AUDITORS","SUPERVISION_AUDITOR","FISCAL_NOTIFICATION_DATE","SUPERVISION_DATE","FISCAL_ACTION_REPORT","MONITORING_USER_NAME","MONITORING_USER_LOGIN","REPORT_ENABLED","LOG_TIMESTAMP","ID","MONITORING_USER_REGISTRATION_ID","MONITORING_USER_ID","HISTORY","FISCAL_ACTION_DATE","FISCAL_NOTIFICATION_LOCK_TIMESTAMP","FISCAL_NOTIFICATION_LOCK_USER","HOMOLOGATION_AUDITOR","FISCAL_ACTION_REPORT_DATE","DESIGNATION_DATE","AWARENESS_AUDITOR","AWARENESS_DATE","FISCAL_NOTIFICATION_STATUS","isEmpty","convertUtcToBrazilianDate","getUserLogin","require","default","NOTIFICATION_STATUS_ENUM","BLANK_FORM_DATA","conditionalHomologationFormat","notification","warningsViewed","key","toString","fiscal_notification_status","VISUALIZADA","homologationUser","fiscal_action_homologation_auditor","awarenessUser","fiscal_notification_awareness_auditor","fiscal_notification_awareness_date","fiscal_action_homologation_date","color","Object","keys","includes","fontWeight","mountWarningHistoryText","warning","data","result","mountWarningHistoryFromLog","mountBaseNotificationHistory","unshift","filter","element","index","indexOf","join","historyMessages","log","status","push","PAUSADO","ENCERRADO","commando_fiscal","SEM_COMANDO","SEM_COMANDO_HOMOLOGADA","EM_MONITORAMENTO"],"mappings":"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","sourcesContent":["import { isFiscalActionDone } from \"common/enumerators/NotificationStatus\";\r\nimport { HOMOLOGATION_DATE } from \"common/model/Notification\";\r\nimport { FISCAL_ACTION_REPORT_AUDITOR } from \"common/model/Notification\";\r\nimport { DESIGNATION_AUDITOR } from \"common/model/Notification\";\r\nimport { FISCAL_NOTIFICATION_LOCK } from \"common/model/Notification\";\r\nimport { FISCAL_ACTION_AUDITORS } from \"common/model/Notification\";\r\nimport { SUPERVISION_AUDITOR } from \"common/model/Notification\";\r\nimport { FISCAL_NOTIFICATION_DATE } from \"common/model/Notification\";\r\nimport { SUPERVISION_DATE } from \"common/model/Notification\";\r\nimport { FISCAL_ACTION_REPORT } from \"common/model/Notification\";\r\nimport { MONITORING_USER_NAME } from \"common/model/Notification\";\r\nimport { MONITORING_USER_LOGIN } from \"common/model/Notification\";\r\nimport { REPORT_ENABLED } from \"common/model/Notification\";\r\nimport { LOG_TIMESTAMP } from \"common/model/Notification\";\r\nimport { ID } from \"common/model/Notification\";\r\nimport { MONITORING_USER_REGISTRATION_ID } from \"common/model/Notification\";\r\nimport { MONITORING_USER_ID } from \"common/model/Notification\";\r\nimport { HISTORY } from \"common/model/Notification\";\r\nimport { FISCAL_ACTION_DATE } from \"common/model/Notification\";\r\nimport { FISCAL_NOTIFICATION_LOCK_TIMESTAMP } from \"common/model/Notification\";\r\nimport { FISCAL_NOTIFICATION_LOCK_USER } from \"common/model/Notification\";\r\nimport { HOMOLOGATION_AUDITOR } from \"common/model/Notification\";\r\nimport { FISCAL_ACTION_REPORT_DATE } from \"common/model/Notification\";\r\nimport { DESIGNATION_DATE } from \"common/model/Notification\";\r\nimport { AWARENESS_AUDITOR } from \"common/model/Notification\";\r\nimport { AWARENESS_DATE } from \"common/model/Notification\";\r\nimport { FISCAL_NOTIFICATION_STATUS } from \"common/model/Notification\";\r\nimport { isEmpty } from \"common/utils/collections\";\r\nimport { convertUtcToBrazilianDate } from \"common/utils/validate\";\r\n\r\nconst { getUserLogin } = require(\"common/SessionUtils\");\r\nconst { default: NOTIFICATION_STATUS_ENUM } = require(\"common/enumerators/NotificationStatus\");\r\n\r\n\r\nexport const BLANK_FORM_DATA = {\r\n  [FISCAL_ACTION_AUDITORS]: {},\r\n  [FISCAL_ACTION_DATE]: \"\",\r\n  [FISCAL_ACTION_REPORT]: \"\",\r\n  [FISCAL_ACTION_REPORT_DATE]: \"\",\r\n  [HISTORY]: \"\",\r\n  [HOMOLOGATION_AUDITOR]: \"\",\r\n  [MONITORING_USER_NAME]: '',\r\n  [MONITORING_USER_ID]: '',\r\n  [MONITORING_USER_LOGIN]: '',\r\n  [MONITORING_USER_REGISTRATION_ID]: '',\r\n  [REPORT_ENABLED]: false\r\n}\r\n\r\n\r\nexport function conditionalHomologationFormat(notification, warningsViewed) {\r\n\r\n  let key = notification[ID].toString()\r\n  let fiscal_notification_status = notification[FISCAL_NOTIFICATION_STATUS]\r\n  if (fiscal_notification_status > NOTIFICATION_STATUS_ENUM.VISUALIZADA) {\r\n    let homologationUser = notification.fiscal_action_homologation_auditor\r\n    let awarenessUser = notification.fiscal_notification_awareness_auditor\r\n\r\n    if ((awarenessUser && awarenessUser === getUserLogin() && !notification.fiscal_notification_awareness_date) ||\r\n      (homologationUser && homologationUser === getUserLogin() && !notification.fiscal_action_homologation_date)) {\r\n      return { color: \"red\" };\r\n    }\r\n  } else if (!Object.keys(warningsViewed).includes(key)) {\r\n    return { fontWeight: 'bold' };\r\n  } else {\r\n    return {}\r\n  }\r\n\r\n}\r\n\r\n//TODO usar o objeto para fazer estas comparações\r\nexport function mountWarningHistoryText(warning, data) {\r\n\r\n  let result = []\r\n\r\n  if (isEmpty(data))\r\n    return result\r\n\r\n  mountWarningHistoryFromLog(data, result)\r\n  mountBaseNotificationHistory(warning, result)  \r\n\r\n  result.unshift(`${convertUtcToBrazilianDate(warning[FISCAL_NOTIFICATION_DATE])}  -   ALERTA DISPARADO`)\r\n\r\n  result = result.filter((element, index) => {\r\n    return result.indexOf(element) === index;\r\n  });\r\n  return result.join(\"\\n\")\r\n\r\n}\r\n\r\n function mountWarningHistoryFromLog(data, historyMessages) { \r\n  \r\n  for (let log of data) {\r\n    let status = log[FISCAL_NOTIFICATION_STATUS]\r\n    if (status === NOTIFICATION_STATUS_ENUM.VISUALIZADA && !log[FISCAL_NOTIFICATION_LOCK_TIMESTAMP]) {\r\n      historyMessages.push(`${convertUtcToBrazilianDate(log[LOG_TIMESTAMP])}  -   ALERTA VISUALIZADO POR ${log[DESIGNATION_AUDITOR]}`)\r\n    } else if (status === NOTIFICATION_STATUS_ENUM.VISUALIZADA && log[FISCAL_NOTIFICATION_LOCK] === 1) {\r\n      historyMessages.push(`${convertUtcToBrazilianDate(log[LOG_TIMESTAMP])}  -   ALERTA BLOQUEADO PARA EDIÇÃO POR ${log[FISCAL_NOTIFICATION_LOCK_USER]}`)\r\n    } else if (status === NOTIFICATION_STATUS_ENUM.VISUALIZADA && log[FISCAL_NOTIFICATION_LOCK] === 0) {\r\n      historyMessages.push(`${convertUtcToBrazilianDate(log[LOG_TIMESTAMP])}  -   ALERTA DESBLOQUEADO PARA EDIÇÃO`)\r\n    } else if (status === NOTIFICATION_STATUS_ENUM.PAUSADO) {\r\n      historyMessages.push(`${convertUtcToBrazilianDate(log[LOG_TIMESTAMP])}  -   CONFIGURAÇÃO DE ALERTA PAUSADA POR ${log[FISCAL_NOTIFICATION_LOCK_USER]} ATÉ ${convertUtcToBrazilianDate(log[FISCAL_NOTIFICATION_LOCK_TIMESTAMP])}`)\r\n    } else if (status === NOTIFICATION_STATUS_ENUM.ENCERRADO) {\r\n      historyMessages.push(`${convertUtcToBrazilianDate(log[LOG_TIMESTAMP])}  -   CONFIGURAÇÃO DE ALERTA ENCERRADA POR ${log[FISCAL_NOTIFICATION_LOCK_USER]} `)\r\n    } \r\n  }\r\n}\r\n\r\n\r\n\r\n function mountBaseNotificationHistory(data, historyMessages) {\r\n\r\n  if (isEmpty(data))\r\n    return historyMessages\r\n\r\n  let status = data[FISCAL_NOTIFICATION_STATUS]\r\n\r\n  let commando_fiscal = [NOTIFICATION_STATUS_ENUM.SEM_COMANDO, NOTIFICATION_STATUS_ENUM.SEM_COMANDO_HOMOLOGADA, NOTIFICATION_STATUS_ENUM.EM_MONITORAMENTO]\r\n\r\n  if (status === NOTIFICATION_STATUS_ENUM.EM_MONITORAMENTO) {\r\n    historyMessages.push(`${convertUtcToBrazilianDate(data[DESIGNATION_DATE])}  -   ALERTA MARCADO COMO \"EM MONITORAMENTO\" POR ${data[DESIGNATION_AUDITOR]} `)\r\n  }\r\n\r\n  if (!isEmpty(data[FISCAL_ACTION_AUDITORS] && !commando_fiscal.includes(status)) ) {\r\n    historyMessages.push(`${convertUtcToBrazilianDate(data[DESIGNATION_DATE])}  -   AÇÃO FISCAL DESIGNADA PARA ${data[FISCAL_ACTION_AUDITORS]} POR ${data[DESIGNATION_AUDITOR]} `)\r\n  }\r\n\r\n  if (status === NOTIFICATION_STATUS_ENUM.SEM_COMANDO) {\r\n    historyMessages.push(`${convertUtcToBrazilianDate(data[DESIGNATION_DATE])}  -   SEM COMANDO FISCAL DISPONÍVEL. REPORTADO POR ${data[DESIGNATION_AUDITOR]} `)\r\n  }\r\n\r\n  if (!isEmpty(data[AWARENESS_DATE])) {\r\n    historyMessages.push(`${convertUtcToBrazilianDate(data[AWARENESS_DATE])}  -   CIÊNCIA DECLARADA POR ${data[AWARENESS_AUDITOR]}`)\r\n  }\r\n\r\n  if (status === NOTIFICATION_STATUS_ENUM.SEM_COMANDO_HOMOLOGADA) {\r\n    historyMessages.push(`${convertUtcToBrazilianDate(data[HOMOLOGATION_DATE])}  -   SEM COMANDO FISCAL DISPONÍVEL. HOMOLOGADO POR ${data[HOMOLOGATION_AUDITOR]} `)\r\n  }\r\n\r\n  if (isFiscalActionDone(status)) {\r\n    historyMessages.push(`${convertUtcToBrazilianDate(data[FISCAL_ACTION_REPORT_DATE])}  -   AÇÃO FISCAL REPORTADA POR ${data[FISCAL_ACTION_REPORT_AUDITOR]}`)\r\n  }\r\n\r\n  if (!isEmpty(data[SUPERVISION_DATE])) {\r\n    historyMessages.push(`${convertUtcToBrazilianDate(data[SUPERVISION_DATE])}  -   SUPERVISÃO DECLARADA POR ${data[SUPERVISION_AUDITOR]}`)\r\n  }\r\n\r\n  if (!isEmpty(data[HOMOLOGATION_DATE]) && !commando_fiscal.includes(status)) {\r\n    historyMessages.push(`${convertUtcToBrazilianDate(data[HOMOLOGATION_DATE])}  -   AÇÃO FISCAL HOMOLOGADA POR ${data[HOMOLOGATION_AUDITOR]}`)\r\n  }\r\n\r\n}"]},"metadata":{},"sourceType":"module"}