{"ast":null,"code":"var _jsxFileName = \"C:\\\\aria\\\\cicc-app\\\\front-end\\\\src\\\\components\\\\modals\\\\NotificationModal\\\\NotificationModal.js\",\n    _s = $RefreshSig$();\n\nimport React from \"react\";\nimport { Nav, NavItem, NavLink, Row, TabContent, TabPane, Input, Button, Modal, ModalBody, ModalHeader, Col } from 'reactstrap';\nimport { BsFillXCircleFill, BsArrowDownCircleFill } from \"react-icons/bs\";\nimport axios from \"axios\";\nimport env from \"common/enviroment\";\nimport axiosRetry from 'axios-retry';\nimport { getTimeoutConfig } from \"axios/AxiosUtils\";\nimport { getRetryConfig } from \"axios/AxiosUtils\";\nimport ConfirmationModal from \"../ConfirmationModal \";\nimport MessageModal from \"../MessageModal\";\nimport MODAL_TYPE_ENUM from \"common/enumerators/ModalTypeEnum\";\nimport { AuditorsContext } from 'context/AuditorsContext';\nimport { WarningsUpdateContext } from \"context/WarningsUpdateContext\";\nimport { GroupsContext } from \"context/GroupsContext\";\nimport { createBaseHttpRequestBody } from \"axios/AxiosUtils\";\nimport NOTIFICATION_STATUS_ENUM from \"common/enumerators/NotificationStatus\";\nimport { compressImage, readFileAsBase64 } from \"./utils/image\";\nimport { EDITION, ERROR, EXCLUSION } from \"../ModalConsts\";\nimport { BLANK_NOTIFICATION_FORM_DATA, DATA_ONLY, DEFAULT_TAB_PANE_NAMES, IMAGE_ONLY, MERGE, NOTHING, TAB_PANE_NAME_WITH_SUPERVISION, emptyBackground } from \"./utils/constants\";\nimport { alowPropagateNotificationData, compareWithOldValues, getNotificationMostRecentStatus, hasEmptyValues, validateData } from \"./utils/rules\";\nimport { useModalWithData } from \"common/hooks/useModalWithData\";\nimport { formatCompletionData, formatConfirmationMessage, formatFiscalAuditors, formatTabBackground, formatTabNames } from \"./utils/format-data\";\nimport { getUserLogin } from \"common/SessionUtils\";\nimport { createSimpleFilterClause } from \"axios/AxiosUtils\";\nimport { createNotFilterClause } from \"axios/AxiosUtils\";\nimport MASK_ENUM from \"common/enumerators/MaskEnum\";\nimport useToggle from \"common/hooks/useToogle\";\nimport { evaluateStatus } from \"common/rules/NotificationRules\";\nimport { FISCAL_NOTIFICATION_PARENT_ID } from \"common/model/Notification\";\nimport { FISCAL_NOTIFICATION_STATUS } from \"common/model/Notification\";\nimport { FISCAL_NOTIFICATION_MODIFICATION_DATE } from \"common/model/Notification\";\nimport { VEHICLE_PLATE } from \"common/model/Notification\";\nimport { ID_CONFIG } from \"common/model/WarningConfig\";\nimport { ID } from \"common/model/Notification\";\nimport { FILTERS } from \"axios/AxiosUtils\";\nimport { NOTIFICATION_ID } from \"common/model/Image\";\nimport { IMAGE_DESCRIPTION } from \"common/model/Image\";\nimport { IMAGE_NAME } from \"common/model/Image\";\nimport { IMAGE_DATA } from \"common/model/Image\";\nimport { IMAGE_PREVIEW } from \"common/model/Image\";\nimport { ID_IMAGE } from \"common/model/Image\";\nimport { NAME } from \"common/model/WarningConfig\";\nimport { REPORT_ENABLED } from \"common/model/Notification\";\nimport { IMAGE_URL } from \"common/model/Image\";\nimport { HISTORY } from \"common/model/Notification\";\nimport useNotification from \"common/hooks/useNotification\";\nimport HomologationPanel from \"./panels/HomologationPanel\";\nimport { AWARENESS_MODE, HOMOLOGATION_MODE, SUPERVISION_MODE } from \"../HomologationModal\";\nimport { isHomologated } from \"common/enumerators/NotificationStatus\";\nimport { SUPERVISION_AUDITOR } from \"common/model/Notification\";\nimport ReportPanel from \"./panels/ReportPanel\";\nimport EventPanel from \"./panels/EventPanel\";\nimport FiscalActionPanel from \"./panels/FiscalActionPanel\";\nimport DesignationPanel from \"./panels/DesignationPanel\";\nimport { escapeSpecialCharacters } from \"common/utils/validate\";\nimport { getNowDateTimeString } from \"common/utils/validate\";\nimport { removeUnicode } from \"common/utils/validate\";\nimport { removeMask } from \"common/utils/mask\";\nimport { treatNullValue } from \"common/utils/collections\";\nimport { treatResponse } from \"common/utils/errorTreatment\";\nimport treatError from \"common/utils/errorTreatment\";\nimport { cpfFilter } from \"components/tags/filterPresets\";\nimport { cnpjFilter } from \"components/tags/filterPresets\";\nimport { isEmpty } from \"common/utils/collections\";\nimport { REPORT_BOOKED_CPF } from \"common/model/Notification\";\nimport { REPORT_BOOKED_CNPJ } from \"common/model/Notification\";\nimport { REPORT_CPF_DRIVER } from \"common/model/Notification\";\nimport { FISCAL_ACTION_AUDITORS } from \"common/model/Notification\";\nimport { HOMOLOGATION_AUDITOR } from \"common/model/Notification\";\nimport { INT } from \"axios/AxiosUtils\";\nimport { GREATER } from \"axios/AxiosUtils\";\nimport { CHAR } from \"axios/AxiosUtils\";\nimport { EQUAL } from \"axios/AxiosUtils\";\nimport { FISCAL_ACTION_REPORT } from \"common/model/Notification\";\nimport { FISCAL_ACTION_DATE } from \"common/model/Notification\";\nimport { FISCAL_ACTION_REPORT_DATE } from \"common/model/Notification\";\nimport { DESIGNATION_AUDITOR } from \"common/model/Notification\";\nimport { MONITORING_USER_LOGIN } from \"common/model/Notification\";\nimport { DESIGNATION_DATE } from \"common/model/Notification\";\nimport { FISCAL_ACTION_REPORT_AUDITOR } from \"common/model/Notification\";\nimport { AWARENESS_AUDITOR } from \"common/model/Notification\";\nimport { REPORT_AI } from \"common/model/Notification\";\nimport { REPORT_DAR } from \"common/model/Notification\";\nimport { REPORT_REVENUE_CODE } from \"common/model/Notification\";\nimport { REPORT_PENALTY_VALUE } from \"common/model/Notification\";\nimport { TRAILER_PLATE } from \"common/model/Notification\";\nimport { REPORT_BOOKED_IE } from \"common/model/Notification\";\nimport { REPORT_LATITUDE } from \"common/model/Notification\";\nimport { REPORT_LONGITUDE } from \"common/model/Notification\";\nimport { REPORT_PRODUCT_NAME } from \"common/model/Notification\";\nimport { wasSuccessRequest } from \"common/utils/errorTreatment\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function NotificationModal(_ref) {\n  _s();\n\n  let {\n    show,\n    toggle,\n    data,\n    initialReadOnlyState,\n    refresh\n  } = _ref;\n  const [tabIndex, setTabIndex] = React.useState(1);\n  const [isFirst, setIsFirst] = React.useState(true);\n  const {\n    getAuditorRegistry\n  } = React.useContext(AuditorsContext);\n  const {\n    getGroupOwnerData,\n    getGroupSupervisorData,\n    getMonitoringGroupOwner\n  } = React.useContext(GroupsContext);\n  const {\n    warningsViewed\n  } = React.useContext(WarningsUpdateContext);\n  const [formData, setFormData] = React.useState(() => data);\n  const [oldFormData] = React.useState(() => JSON.parse(JSON.stringify(data)));\n  const [spinner, setSpinner] = React.useState(false);\n  const [invalid, setInvalid] = React.useState(false);\n  const [readOnly, setReadOnly] = React.useState(initialReadOnlyState);\n  const [mode, setMode] = React.useState({\n    awareness: false,\n    homologation: false,\n    supervision: false,\n    edition: false\n  });\n  const [updateAuditorsResponsibleFlag, toggleUpdateAuditorsResponsible] = useToggle(false);\n  const [imagesToUpload, setImagesToUpload] = React.useState({\n    'previews': [],\n    'images': []\n  });\n  const {\n    modalData,\n    setModalData,\n    modalActionMethods,\n    setModalActionMethods,\n    isModalActive,\n    modalType,\n    toggleModalOn,\n    toggleModalOff,\n    toogleMessageModalOn,\n    toogleConfirmationModalOn\n  } = useModalWithData();\n  const {\n    mountAuditorsResponsibles\n  } = useNotification(getAuditorRegistry, getMonitoringGroupOwner, getGroupOwnerData, getGroupSupervisorData);\n  const [notificationImages, setNotificationImages] = React.useState([]);\n  const axiosRetryProxy = axios.create(getTimeoutConfig());\n  axiosRetry(axiosRetryProxy, getRetryConfig());\n  React.useEffect(() => {\n    if (data) {\n      if (data[REPORT_BOOKED_CPF]) data[REPORT_BOOKED_CPF] = cpfFilter.mask.encode(data[REPORT_BOOKED_CPF]);\n      if (data[REPORT_BOOKED_CNPJ]) data[REPORT_BOOKED_CNPJ] = cnpjFilter.mask.encode(data[REPORT_BOOKED_CNPJ]);\n      if (data[REPORT_CPF_DRIVER]) data[REPORT_CPF_DRIVER] = cpfFilter.mask.encode(data[REPORT_CPF_DRIVER]);\n    }\n\n    setFormData(data);\n  }, [data]);\n  React.useEffect(() => {\n    let httpRequestBody = createBaseHttpRequestBody();\n    httpRequestBody[NOTIFICATION_ID] = data[FISCAL_NOTIFICATION_PARENT_ID];\n    axiosRetryProxy.post(\"\".concat(env.apiAddress, \"/warning_images/download\"), httpRequestBody).then(res => {\n      let data = res.data.map(image => {\n        return { ...image,\n          preview: image.preview ? image.preview : \"\"\n        };\n      });\n      setNotificationImages(data);\n    }).catch(err => {\n      console.log('error ao receber imagens:', err);\n    }); // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  React.useEffect(() => {\n    //Este método abaixo só deve ser chamado quando houver edição dos fiscais responsáveis pela ação fiscal \n    if (!isFirst) {\n      let newData = mountAuditorsResponsibles(formData);\n      setFormData({ ...newData\n      });\n    } else {\n      setIsFirst(false);\n    } // eslint-disable-next-line react-hooks/exhaustive-deps  \n\n  }, [updateAuditorsResponsibleFlag]);\n\n  const cleanInputs = () => {\n    setFormData({ ...BLANK_NOTIFICATION_FORM_DATA,\n      [FISCAL_ACTION_AUDITORS]: {},\n      [HOMOLOGATION_AUDITOR]: \"\"\n    });\n  };\n\n  function redirectHistory() {\n    window.open('/notification_history', '_blank');\n  }\n\n  ;\n\n  const removeImageToUpload = index => {\n    setImagesToUpload(prevState => ({\n      previews: prevState.previews.filter((_, i) => i !== index),\n      images: prevState.images.filter((_, i) => i !== index)\n    }));\n  };\n\n  function enableEditionButton(status) {\n    if (isHomologated(status) || status === NOTIFICATION_STATUS_ENUM.SEM_COMANDO_HOMOLOGADA) {\n      return false;\n    }\n\n    return true;\n  }\n\n  const addImageToUpload = event => {\n    const images = event.target.files;\n    const imagesArray = Array.from(images);\n    setImagesToUpload(prevState => ({ ...prevState,\n      images: [...prevState.images, ...imagesArray]\n    }));\n    const readerPromises = imagesArray.map(image => {\n      return new Promise(resolve => {\n        const reader = new FileReader();\n\n        reader.onload = () => {\n          resolve(compressImage(reader.result));\n        };\n\n        reader.readAsDataURL(image);\n      });\n    });\n    Promise.all(readerPromises).then(results => {\n      setImagesToUpload(prevState => ({ ...prevState,\n        previews: [...prevState.previews, ...results]\n      }));\n    });\n  };\n\n  const propagateNotificationData = async (warning, httpRequestBody) => {\n    let status = httpRequestBody[FISCAL_NOTIFICATION_STATUS];\n    delete httpRequestBody[FISCAL_NOTIFICATION_MODIFICATION_DATE];\n    httpRequestBody[FISCAL_NOTIFICATION_STATUS] = status * NOTIFICATION_STATUS_ENUM.IMPORTED_STATUS_CODE;\n    let filters = [];\n    filters.push(createSimpleFilterClause(VEHICLE_PLATE, CHAR, EQUAL, warning[VEHICLE_PLATE]));\n    filters.push(createSimpleFilterClause(ID_CONFIG, CHAR, EQUAL, warning[ID_CONFIG]));\n    filters.push(createSimpleFilterClause(ID, INT, GREATER, warning[FISCAL_NOTIFICATION_PARENT_ID]));\n    filters.push(createSimpleFilterClause(FISCAL_NOTIFICATION_STATUS, INT, GREATER, NOTIFICATION_STATUS_ENUM.DESIGNADA));\n    filters.push(createNotFilterClause(ID, INT, EQUAL, warning[ID]));\n    httpRequestBody[FILTERS] = filters;\n    axios.patch(\"\".concat(env.apiAddress, \"/warnings/update_by_filter/\"), httpRequestBody).then(res => {\n      refresh();\n      return res;\n    }).catch(err => {\n      return err;\n    });\n  };\n\n  const updateNotification = async () => {\n    let httpRequestBody = createBaseHttpRequestBody({\n      [FISCAL_NOTIFICATION_PARENT_ID]: formData[FISCAL_NOTIFICATION_PARENT_ID],\n      [FISCAL_ACTION_AUDITORS]: formatFiscalAuditors(Object.values(formData[FISCAL_ACTION_AUDITORS])),\n      [FISCAL_ACTION_REPORT]: escapeSpecialCharacters(formData[FISCAL_ACTION_REPORT]),\n      [FISCAL_ACTION_DATE]: \"\".concat(formData[FISCAL_ACTION_DATE][0], \"T\").concat(formData[FISCAL_ACTION_DATE][1]),\n      [FISCAL_ACTION_REPORT_DATE]: getNowDateTimeString(),\n      [FISCAL_NOTIFICATION_MODIFICATION_DATE]: getNowDateTimeString(),\n      [DESIGNATION_AUDITOR]: formData[MONITORING_USER_LOGIN],\n      [DESIGNATION_DATE]: formData[DESIGNATION_DATE],\n      [FISCAL_ACTION_REPORT_AUDITOR]: getUserLogin(),\n      [HOMOLOGATION_AUDITOR]: formData[HOMOLOGATION_AUDITOR],\n      [AWARENESS_AUDITOR]: formData[AWARENESS_AUDITOR],\n      [REPORT_ENABLED]: formData[REPORT_ENABLED],\n      [REPORT_AI]: escapeSpecialCharacters(removeUnicode(formData[REPORT_AI])),\n      [REPORT_DAR]: escapeSpecialCharacters(removeUnicode(formData[REPORT_DAR])),\n      [REPORT_REVENUE_CODE]: escapeSpecialCharacters(removeUnicode(formData[REPORT_REVENUE_CODE])),\n      [REPORT_PENALTY_VALUE]: removeMask(removeUnicode(formData[REPORT_PENALTY_VALUE]), MASK_ENUM.MONEY),\n      [TRAILER_PLATE]: escapeSpecialCharacters(removeUnicode(formData[TRAILER_PLATE])),\n      [VEHICLE_PLATE]: escapeSpecialCharacters(removeUnicode(formData[VEHICLE_PLATE])),\n      [REPORT_CPF_DRIVER]: escapeSpecialCharacters(removeMask(formData[REPORT_CPF_DRIVER])),\n      [REPORT_BOOKED_IE]: escapeSpecialCharacters(removeUnicode(formData[REPORT_BOOKED_IE])),\n      [REPORT_BOOKED_CPF]: escapeSpecialCharacters(removeMask(formData[REPORT_BOOKED_CPF])),\n      [REPORT_BOOKED_CNPJ]: escapeSpecialCharacters(removeMask(formData[REPORT_BOOKED_CNPJ])),\n      [REPORT_LATITUDE]: treatNullValue(removeUnicode(formData[REPORT_LATITUDE]), 0.0),\n      [REPORT_LONGITUDE]: treatNullValue(removeUnicode(formData[REPORT_LONGITUDE]), 0.0),\n      [REPORT_PRODUCT_NAME]: escapeSpecialCharacters(formData[REPORT_PRODUCT_NAME])\n    });\n    let newStatus = evaluateStatus(httpRequestBody, formData[FISCAL_NOTIFICATION_STATUS]);\n    httpRequestBody[FISCAL_NOTIFICATION_STATUS] = newStatus;\n    return await axios.patch(\"\".concat(env.apiAddress, \"/warnings/update/\").concat(formData[ID]), httpRequestBody).then(async res => {\n      if (wasSuccessRequest(res, ID)) {\n        setFormData({ ...formData,\n          [FISCAL_NOTIFICATION_STATUS]: newStatus\n        });\n\n        if (alowPropagateNotificationData(formData)) {\n          await propagateNotificationData(formData, httpRequestBody);\n        }\n      }\n\n      return res;\n    }).catch(err => {\n      return err;\n    });\n  };\n\n  const uploadImage = async image => {\n    let httpRequestBody = createBaseHttpRequestBody();\n    httpRequestBody[NOTIFICATION_ID] = formData[FISCAL_NOTIFICATION_PARENT_ID];\n    httpRequestBody[IMAGE_DESCRIPTION] = image[IMAGE_NAME];\n    const base64String = await readFileAsBase64(image, false);\n    httpRequestBody[IMAGE_DATA] = base64String.replace(/^data:image\\/(png|jpeg);base64,/, '');\n    httpRequestBody[IMAGE_PREVIEW] = base64String;\n\n    if (httpRequestBody[IMAGE_DESCRIPTION] && httpRequestBody[IMAGE_DESCRIPTION].includes(\"derzu\")) {\n      console.log(\"DERZU1\", base64String.length);\n      console.log(\"DERZU2\", base64String);\n      console.log(\"DERZU3\", httpRequestBody['image_data'].length);\n      console.log(\"DERZU4\", httpRequestBody['image_data']);\n    }\n\n    try {\n      let res = await axios.post(\"\".concat(env.apiAddress, \"/warning_images/upload\"), httpRequestBody); //resolve();\n\n      return res;\n    } catch (err) {\n      //reject()\n      console.log(err);\n      return err;\n    }\n  };\n\n  const update = async mode => {\n    setSpinner(true);\n    toggleModalOn(MODAL_TYPE_ENUM.MESSAGE);\n    let promisses = [];\n\n    if (mode === DATA_ONLY || mode === MERGE) {\n      promisses.push(updateNotification());\n    }\n\n    if (mode === IMAGE_ONLY || mode === MERGE) {\n      for (const image of imagesToUpload.images) {\n        let imagePromisse = uploadImage(image);\n        promisses.push(imagePromisse);\n      }\n    }\n\n    try {\n      let responses = await Promise.all(promisses);\n      let data = formatCompletionData(mode, responses);\n      refresh();\n      toogleMessageModalOn(data.message, data.icon);\n    } catch (error) {\n      console.log(error);\n      toogleMessageModalOn(\"Falha na atualização da Notificação!\", ERROR);\n    } finally {\n      setMode({ ...mode,\n        edition: false\n      });\n      setSpinner(false);\n    }\n  };\n\n  const deleteImage = async imageIndex => {\n    const entity = \"da Imagem\";\n    let httpRequestBody = createBaseHttpRequestBody();\n    httpRequestBody[NOTIFICATION_ID] = formData[FISCAL_NOTIFICATION_PARENT_ID];\n    httpRequestBody[ID_IMAGE] = notificationImages[imageIndex][ID_IMAGE];\n    axios.post(\"\".concat(env.apiAddress, \"/warning_images/delete\"), httpRequestBody).then(res => {\n      treatResponse(entity, EXCLUSION, ID_IMAGE, res, setModalData, refresh);\n    }).catch(err => {\n      setModalData(treatError(err, entity, EXCLUSION));\n    }).finally(() => {\n      setSpinner(false);\n      cleanInputs();\n    });\n  };\n\n  const openDeleteConfirmationModal = imageIndex => {\n    setModalActionMethods([undefined, undefined, deleteImage]);\n    setModalData({\n      message: 'Confima a exclusão desta imagem?',\n      operation: EXCLUSION,\n      id: imageIndex\n    });\n    toggleModalOn(MODAL_TYPE_ENUM.CONFIRMATION);\n  };\n\n  const openConfirmationModal = () => {\n    let errorMessages = validateData(formData);\n\n    if (hasEmptyValues(formData)) {\n      setInvalid(true);\n      toogleMessageModalOn(\"Há campos obrigatórios não preenchidos!\", ERROR);\n    } else if (!isEmpty(errorMessages)) {\n      setInvalid(true);\n      let errorMessage = \"Há campos obrigatórios com dados inválidos:\\n\";\n      errorMessage += errorMessages.join(\"\");\n      toogleMessageModalOn(errorMessage, ERROR);\n    } else {\n      let hasImageModification = imagesToUpload.images.length > 0;\n      let hasDataModification = !compareWithOldValues(formData, oldFormData);\n      let mode = hasDataModification ? DATA_ONLY : NOTHING;\n      mode = !hasDataModification && hasImageModification ? IMAGE_ONLY : mode;\n      mode = hasDataModification && hasImageModification ? MERGE : mode;\n      setInvalid(false);\n\n      if (mode === NOTHING) {\n        let errorMessage = \"Não há alterações a serem salvas para esta notificação!\";\n        toogleMessageModalOn(errorMessage, ERROR);\n      } else {\n        let message = formatConfirmationMessage(mode);\n        let data = {\n          message: message,\n          operation: EDITION,\n          id: formData[ID]\n        };\n        toogleConfirmationModalOn(data, () => {\n          setSpinner(true);\n          update(mode, formData[ID]);\n          setReadOnly(true);\n        });\n      }\n    }\n  };\n\n  const getTabPaneNames = () => {\n    if (isEmpty(formData[SUPERVISION_AUDITOR])) {\n      return DEFAULT_TAB_PANE_NAMES;\n    } else {\n      return TAB_PANE_NAME_WITH_SUPERVISION;\n    }\n  };\n\n  const EditionButton = () => {\n    return /*#__PURE__*/_jsxDEV(Row, {\n      children: enableEditionButton(formData[FISCAL_NOTIFICATION_STATUS]) && /*#__PURE__*/_jsxDEV(Col, {\n        style: {\n          textAlign: \"end\",\n          marginTop: \"10px\"\n        },\n        children: readOnly ? /*#__PURE__*/_jsxDEV(Button, {\n          color: \"primary\",\n          onClick: () => {\n            setReadOnly(false);\n            setTabIndex(3);\n            setMode({ ...mode,\n              edition: true\n            });\n          },\n          style: {\n            width: \"12rem\",\n            height: \"2.5rem\",\n            marginTop: \"10px\"\n          },\n          children: \"Editar A\\xE7\\xE3o Fiscal\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 471,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(Button, {\n            color: \"primary\",\n            onClick: () => {\n              openConfirmationModal();\n            },\n            style: {\n              marginRight: \"1rem\",\n              marginTop: \"10px\"\n            },\n            children: \"Salvar\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 477,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            color: \"danger\",\n            style: {\n              marginTop: \"10px\"\n            },\n            onClick: () => {\n              setFormData(JSON.parse(JSON.stringify(oldFormData)));\n              setMode({ ...mode,\n                edition: false\n              });\n              setReadOnly(true);\n            },\n            children: \"Cancelar\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 486,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 469,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 467,\n      columnNumber: 12\n    }, this);\n  };\n\n  const BuildNavigationPart = () => {\n    return /*#__PURE__*/_jsxDEV(Nav, {\n      tabs: true,\n      style: {\n        background: \"#f2f2f2\"\n      },\n      children: Object.entries(getTabPaneNames()).map(key_value => {\n        return /*#__PURE__*/_jsxDEV(NavItem, {\n          style: {\n            cursor: \"pointer\"\n          },\n          children: /*#__PURE__*/_jsxDEV(NavLink, {\n            className: tabIndex === key_value[1] ? \"active\" : \"\",\n            style: formatTabBackground(mode, key_value[1]),\n            onClick: () => {\n              setTabIndex(key_value[1]);\n            },\n            children: formatTabNames(mode, key_value[1], key_value[0])\n          }, key_value[0], false, {\n            fileName: _jsxFileName,\n            lineNumber: 511,\n            columnNumber: 17\n          }, this)\n        }, key_value[0], false, {\n          fileName: _jsxFileName,\n          lineNumber: 510,\n          columnNumber: 15\n        }, this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 506,\n      columnNumber: 7\n    }, this);\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Modal, {\n      isOpen: show,\n      toggle: toggle,\n      size: \"lg\",\n      children: [/*#__PURE__*/_jsxDEV(ModalHeader, {\n        toggle: toggle,\n        style: {\n          padding: \"10px 15px\"\n        },\n        children: \"\".concat(formData[NAME], \" (Ocorr\\xEAncia \").concat(formData[ID], \") - \").concat(getNotificationMostRecentStatus(formData[ID], formData[FISCAL_NOTIFICATION_STATUS], warningsViewed))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 530,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(ModalBody, {\n        style: {\n          alignContent: 'center',\n          padding: \"0px\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(BuildNavigationPart, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 534,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(TabContent, {\n          activeTab: \"\".concat(tabIndex),\n          style: {\n            padding: \"15px\"\n          },\n          children: [/*#__PURE__*/_jsxDEV(TabPane, {\n            tabId: \"1\",\n            children: /*#__PURE__*/_jsxDEV(EventPanel, {\n              data: formData\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 538,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 536,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(TabPane, {\n            tabId: \"2\",\n            children: [/*#__PURE__*/_jsxDEV(DesignationPanel, {\n              data: formData\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 544,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(HomologationPanel, {\n              data: formData,\n              setData: setFormData,\n              refresh: refresh,\n              homologationType: AWARENESS_MODE,\n              setMode: setMode,\n              mode: mode\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 546,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 542,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(TabPane, {\n            tabId: \"3\",\n            children: [/*#__PURE__*/_jsxDEV(FiscalActionPanel, {\n              data: formData,\n              setData: setFormData,\n              oldData: oldFormData,\n              readOnly: readOnly,\n              invalid: invalid,\n              refresh: toggleUpdateAuditorsResponsible\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 552,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(EditionButton, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 554,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 550,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(TabPane, {\n            tabId: \"4\",\n            children: [/*#__PURE__*/_jsxDEV(ReportPanel, {\n              data: formData,\n              setData: setFormData,\n              oldData: oldFormData,\n              invalid: invalid,\n              readOnly: readOnly\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 559,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(EditionButton, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 561,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 558,\n            columnNumber: 13\n          }, this), tabIndex === 5 && /*#__PURE__*/_jsxDEV(TabPane, {\n            tabId: \"5\",\n            children: [!imagesToUpload.previews.length && notificationImages.length === 0 && emptyBackground, /*#__PURE__*/_jsxDEV(Row, {\n              style: {\n                display: 'flex',\n                flexWrap: 'wrap',\n                padding: '10px',\n                maxWidth: '100%',\n                overflowX: 'auto',\n                margin: '0'\n              },\n              children: [notificationImages.map((notificationImg, index) => /*#__PURE__*/_jsxDEV(Col, {\n                md: \"4\",\n                xs: \"4\",\n                style: {\n                  margin: '0px 0px 15px 0px'\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                  src: notificationImg[IMAGE_PREVIEW],\n                  alt: \"Preview2 \".concat(index),\n                  style: {\n                    margin: '0px 0px 0px 5px'\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 570,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n                  href: \"\".concat(notificationImg[IMAGE_URL]),\n                  children: /*#__PURE__*/_jsxDEV(BsArrowDownCircleFill, {\n                    style: {\n                      color: 'green',\n                      fontSize: '20px',\n                      position: 'absolute',\n                      top: '20px',\n                      right: '1px',\n                      cursor: 'pointer'\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 572,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 571,\n                  columnNumber: 23\n                }, this), !readOnly && /*#__PURE__*/_jsxDEV(BsFillXCircleFill, {\n                  onClick: () => openDeleteConfirmationModal(index),\n                  style: {\n                    color: '#EF8157',\n                    fontSize: '20px',\n                    position: 'absolute',\n                    top: '-1px',\n                    right: '1px',\n                    cursor: 'pointer'\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 574,\n                  columnNumber: 37\n                }, this)]\n              }, index, true, {\n                fileName: _jsxFileName,\n                lineNumber: 569,\n                columnNumber: 21\n              }, this)), imagesToUpload.previews.map((previewImg, index) => /*#__PURE__*/_jsxDEV(Col, {\n                md: \"4\",\n                xs: \"4\",\n                style: {\n                  margin: '0px 0px 15px 0px'\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                  src: previewImg,\n                  alt: \"Preview \".concat(index),\n                  style: {\n                    maxWidth: '100%',\n                    margin: '5px',\n                    position: 'relative'\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 579,\n                  columnNumber: 23\n                }, this), !readOnly && /*#__PURE__*/_jsxDEV(BsFillXCircleFill, {\n                  onClick: () => removeImageToUpload(index),\n                  style: {\n                    color: '#EF8157',\n                    fontSize: '20px',\n                    position: 'absolute',\n                    top: '-1px',\n                    right: '1px',\n                    cursor: 'pointer'\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 580,\n                  columnNumber: 37\n                }, this)]\n              }, index, true, {\n                fileName: _jsxFileName,\n                lineNumber: 578,\n                columnNumber: 21\n              }, this))]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 567,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(Row, {\n              children: /*#__PURE__*/_jsxDEV(Col, {\n                style: {\n                  textAlign: \"center\"\n                },\n                children: /*#__PURE__*/_jsxDEV(\"label\", {\n                  htmlFor: \"file-upload\",\n                  readOnly: readOnly,\n                  disabled: readOnly,\n                  className: \"custom-file-upload btn btn-primary\",\n                  style: {\n                    marginTop: '65px',\n                    marginBottom: '49px'\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                    id: \"file-upload\",\n                    type: \"file\",\n                    multiple: true,\n                    readOnly: readOnly,\n                    disabled: readOnly,\n                    accept: \"image/png,image/jpeg\",\n                    onChange: addImageToUpload,\n                    style: {\n                      display: 'none'\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 587,\n                    columnNumber: 23\n                  }, this), \"Selecionar Imagens\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 586,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 585,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 584,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(EditionButton, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 602,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 565,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(TabPane, {\n            tabId: \"6\",\n            children: /*#__PURE__*/_jsxDEV(HomologationPanel, {\n              data: formData,\n              setData: setFormData,\n              refresh: refresh,\n              homologationType: SUPERVISION_MODE,\n              setMode: setMode,\n              mode: mode\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 608,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 607,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(TabPane, {\n            tabId: \"7\",\n            children: /*#__PURE__*/_jsxDEV(HomologationPanel, {\n              data: formData,\n              setData: setFormData,\n              refresh: refresh,\n              homologationType: HOMOLOGATION_MODE,\n              setMode: setMode,\n              mode: mode\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 612,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 611,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(TabPane, {\n            tabId: \"8\",\n            children: /*#__PURE__*/_jsxDEV(Row, {\n              style: {\n                marginTop: '5px'\n              },\n              children: /*#__PURE__*/_jsxDEV(Col, {\n                children: [/*#__PURE__*/_jsxDEV(\"b\", {\n                  children: [\"Hist\\xF3rico (\", /*#__PURE__*/_jsxDEV(\"a\", {\n                    style: {\n                      color: \"#51cbce\",\n                      cursor: \"pointer\"\n                    },\n                    onClick: () => {\n                      redirectHistory();\n                    },\n                    children: \"Vers\\xE3o Completa\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 618,\n                    columnNumber: 33\n                  }, this), \"):\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 618,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Input, {\n                  type: \"textarea\",\n                  value: formData[HISTORY],\n                  readOnly: true,\n                  maxLength: \"2048\",\n                  style: {\n                    minHeight: \"21em\",\n                    padding: \"6px 7px 6px 12px\"\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 619,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 617,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 616,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 615,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 535,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 533,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 529,\n      columnNumber: 7\n    }, this), modalType === MODAL_TYPE_ENUM.CONFIRMATION && /*#__PURE__*/_jsxDEV(ConfirmationModal, {\n      show: isModalActive,\n      toggle: toggleModalOff,\n      data: modalData,\n      actionMethods: modalActionMethods\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 634,\n      columnNumber: 54\n    }, this), modalType === MODAL_TYPE_ENUM.MESSAGE && /*#__PURE__*/_jsxDEV(MessageModal, {\n      show: isModalActive,\n      toggle: toggleModalOff,\n      data: modalData,\n      spinner: spinner\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 635,\n      columnNumber: 49\n    }, this)]\n  }, void 0, true);\n}\n\n_s(NotificationModal, \"lSang2shU7/BUMAnc+pFPK3p+c8=\", false, function () {\n  return [useToggle, useModalWithData, useNotification];\n});\n\n_c = NotificationModal;\n\nvar _c;\n\n$RefreshReg$(_c, \"NotificationModal\");","map":{"version":3,"sources":["C:/aria/cicc-app/front-end/src/components/modals/NotificationModal/NotificationModal.js"],"names":["React","Nav","NavItem","NavLink","Row","TabContent","TabPane","Input","Button","Modal","ModalBody","ModalHeader","Col","BsFillXCircleFill","BsArrowDownCircleFill","axios","env","axiosRetry","getTimeoutConfig","getRetryConfig","ConfirmationModal","MessageModal","MODAL_TYPE_ENUM","AuditorsContext","WarningsUpdateContext","GroupsContext","createBaseHttpRequestBody","NOTIFICATION_STATUS_ENUM","compressImage","readFileAsBase64","EDITION","ERROR","EXCLUSION","BLANK_NOTIFICATION_FORM_DATA","DATA_ONLY","DEFAULT_TAB_PANE_NAMES","IMAGE_ONLY","MERGE","NOTHING","TAB_PANE_NAME_WITH_SUPERVISION","emptyBackground","alowPropagateNotificationData","compareWithOldValues","getNotificationMostRecentStatus","hasEmptyValues","validateData","useModalWithData","formatCompletionData","formatConfirmationMessage","formatFiscalAuditors","formatTabBackground","formatTabNames","getUserLogin","createSimpleFilterClause","createNotFilterClause","MASK_ENUM","useToggle","evaluateStatus","FISCAL_NOTIFICATION_PARENT_ID","FISCAL_NOTIFICATION_STATUS","FISCAL_NOTIFICATION_MODIFICATION_DATE","VEHICLE_PLATE","ID_CONFIG","ID","FILTERS","NOTIFICATION_ID","IMAGE_DESCRIPTION","IMAGE_NAME","IMAGE_DATA","IMAGE_PREVIEW","ID_IMAGE","NAME","REPORT_ENABLED","IMAGE_URL","HISTORY","useNotification","HomologationPanel","AWARENESS_MODE","HOMOLOGATION_MODE","SUPERVISION_MODE","isHomologated","SUPERVISION_AUDITOR","ReportPanel","EventPanel","FiscalActionPanel","DesignationPanel","escapeSpecialCharacters","getNowDateTimeString","removeUnicode","removeMask","treatNullValue","treatResponse","treatError","cpfFilter","cnpjFilter","isEmpty","REPORT_BOOKED_CPF","REPORT_BOOKED_CNPJ","REPORT_CPF_DRIVER","FISCAL_ACTION_AUDITORS","HOMOLOGATION_AUDITOR","INT","GREATER","CHAR","EQUAL","FISCAL_ACTION_REPORT","FISCAL_ACTION_DATE","FISCAL_ACTION_REPORT_DATE","DESIGNATION_AUDITOR","MONITORING_USER_LOGIN","DESIGNATION_DATE","FISCAL_ACTION_REPORT_AUDITOR","AWARENESS_AUDITOR","REPORT_AI","REPORT_DAR","REPORT_REVENUE_CODE","REPORT_PENALTY_VALUE","TRAILER_PLATE","REPORT_BOOKED_IE","REPORT_LATITUDE","REPORT_LONGITUDE","REPORT_PRODUCT_NAME","wasSuccessRequest","NotificationModal","show","toggle","data","initialReadOnlyState","refresh","tabIndex","setTabIndex","useState","isFirst","setIsFirst","getAuditorRegistry","useContext","getGroupOwnerData","getGroupSupervisorData","getMonitoringGroupOwner","warningsViewed","formData","setFormData","oldFormData","JSON","parse","stringify","spinner","setSpinner","invalid","setInvalid","readOnly","setReadOnly","mode","setMode","awareness","homologation","supervision","edition","updateAuditorsResponsibleFlag","toggleUpdateAuditorsResponsible","imagesToUpload","setImagesToUpload","modalData","setModalData","modalActionMethods","setModalActionMethods","isModalActive","modalType","toggleModalOn","toggleModalOff","toogleMessageModalOn","toogleConfirmationModalOn","mountAuditorsResponsibles","notificationImages","setNotificationImages","axiosRetryProxy","create","useEffect","mask","encode","httpRequestBody","post","apiAddress","then","res","map","image","preview","catch","err","console","log","newData","cleanInputs","redirectHistory","window","open","removeImageToUpload","index","prevState","previews","filter","_","i","images","enableEditionButton","status","SEM_COMANDO_HOMOLOGADA","addImageToUpload","event","target","files","imagesArray","Array","from","readerPromises","Promise","resolve","reader","FileReader","onload","result","readAsDataURL","all","results","propagateNotificationData","warning","IMPORTED_STATUS_CODE","filters","push","DESIGNADA","patch","updateNotification","Object","values","MONEY","newStatus","uploadImage","base64String","replace","includes","length","update","MESSAGE","promisses","imagePromisse","responses","message","icon","error","deleteImage","imageIndex","entity","finally","openDeleteConfirmationModal","undefined","operation","id","CONFIRMATION","openConfirmationModal","errorMessages","errorMessage","join","hasImageModification","hasDataModification","getTabPaneNames","EditionButton","textAlign","marginTop","width","height","marginRight","BuildNavigationPart","background","entries","key_value","cursor","padding","alignContent","display","flexWrap","maxWidth","overflowX","margin","notificationImg","color","fontSize","position","top","right","previewImg","marginBottom","minHeight"],"mappings":"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","sourcesContent":["import React from \"react\";\r\n\r\nimport {\r\n  Nav,\r\n  NavItem,\r\n  NavLink,\r\n  Row,\r\n  TabContent,\r\n  TabPane,\r\n  Input,\r\n  Button,\r\n  Modal,\r\n  ModalBody,\r\n  ModalHeader,\r\n  Col,\r\n} from 'reactstrap';\r\n\r\nimport { BsFillXCircleFill, BsArrowDownCircleFill } from \"react-icons/bs\";\r\n\r\nimport axios from \"axios\";\r\nimport env from \"common/enviroment\";\r\nimport axiosRetry from 'axios-retry';\r\nimport { getTimeoutConfig } from \"axios/AxiosUtils\";\r\nimport { getRetryConfig } from \"axios/AxiosUtils\";\r\n\r\nimport ConfirmationModal from \"../ConfirmationModal \";\r\nimport MessageModal from \"../MessageModal\";\r\nimport MODAL_TYPE_ENUM from \"common/enumerators/ModalTypeEnum\";\r\n\r\nimport { AuditorsContext } from 'context/AuditorsContext'\r\nimport { WarningsUpdateContext } from \"context/WarningsUpdateContext\";\r\nimport { GroupsContext } from \"context/GroupsContext\";\r\n\r\nimport { createBaseHttpRequestBody } from \"axios/AxiosUtils\";\r\nimport NOTIFICATION_STATUS_ENUM from \"common/enumerators/NotificationStatus\";\r\nimport { compressImage, readFileAsBase64 } from \"./utils/image\";\r\nimport { EDITION, ERROR, EXCLUSION } from \"../ModalConsts\";\r\nimport { BLANK_NOTIFICATION_FORM_DATA, DATA_ONLY, DEFAULT_TAB_PANE_NAMES, IMAGE_ONLY, MERGE, NOTHING, TAB_PANE_NAME_WITH_SUPERVISION, emptyBackground } from \"./utils/constants\";\r\nimport { alowPropagateNotificationData, compareWithOldValues, getNotificationMostRecentStatus, hasEmptyValues, validateData } from \"./utils/rules\";\r\nimport { useModalWithData } from \"common/hooks/useModalWithData\";\r\nimport { formatCompletionData, formatConfirmationMessage, formatFiscalAuditors, formatTabBackground, formatTabNames } from \"./utils/format-data\";\r\nimport { getUserLogin } from \"common/SessionUtils\";\r\nimport { createSimpleFilterClause } from \"axios/AxiosUtils\";\r\nimport { createNotFilterClause } from \"axios/AxiosUtils\";\r\nimport MASK_ENUM from \"common/enumerators/MaskEnum\";\r\nimport useToggle from \"common/hooks/useToogle\";\r\nimport { evaluateStatus } from \"common/rules/NotificationRules\";\r\nimport { FISCAL_NOTIFICATION_PARENT_ID } from \"common/model/Notification\";\r\nimport { FISCAL_NOTIFICATION_STATUS } from \"common/model/Notification\";\r\nimport { FISCAL_NOTIFICATION_MODIFICATION_DATE } from \"common/model/Notification\";\r\nimport { VEHICLE_PLATE } from \"common/model/Notification\";\r\nimport { ID_CONFIG } from \"common/model/WarningConfig\";\r\nimport { ID } from \"common/model/Notification\";\r\nimport { FILTERS } from \"axios/AxiosUtils\";\r\nimport { NOTIFICATION_ID } from \"common/model/Image\";\r\nimport { IMAGE_DESCRIPTION } from \"common/model/Image\";\r\nimport { IMAGE_NAME } from \"common/model/Image\";\r\nimport { IMAGE_DATA } from \"common/model/Image\";\r\nimport { IMAGE_PREVIEW } from \"common/model/Image\";\r\nimport { ID_IMAGE } from \"common/model/Image\";\r\nimport { NAME } from \"common/model/WarningConfig\";\r\n\r\n\r\nimport { REPORT_ENABLED } from \"common/model/Notification\";\r\n\r\nimport { IMAGE_URL } from \"common/model/Image\";\r\nimport { HISTORY } from \"common/model/Notification\";\r\nimport useNotification from \"common/hooks/useNotification\";\r\nimport HomologationPanel from \"./panels/HomologationPanel\";\r\nimport { AWARENESS_MODE, HOMOLOGATION_MODE, SUPERVISION_MODE } from \"../HomologationModal\";\r\nimport { isHomologated } from \"common/enumerators/NotificationStatus\";\r\nimport { SUPERVISION_AUDITOR } from \"common/model/Notification\";\r\nimport ReportPanel from \"./panels/ReportPanel\";\r\nimport EventPanel from \"./panels/EventPanel\";\r\nimport FiscalActionPanel from \"./panels/FiscalActionPanel\";\r\nimport DesignationPanel from \"./panels/DesignationPanel\";\r\nimport { escapeSpecialCharacters } from \"common/utils/validate\";\r\nimport { getNowDateTimeString } from \"common/utils/validate\";\r\nimport { removeUnicode } from \"common/utils/validate\";\r\nimport { removeMask } from \"common/utils/mask\";\r\nimport { treatNullValue } from \"common/utils/collections\";\r\nimport { treatResponse } from \"common/utils/errorTreatment\";\r\nimport treatError from \"common/utils/errorTreatment\";\r\nimport { cpfFilter } from \"components/tags/filterPresets\";\r\nimport { cnpjFilter } from \"components/tags/filterPresets\";\r\nimport { isEmpty } from \"common/utils/collections\";\r\nimport { REPORT_BOOKED_CPF } from \"common/model/Notification\";\r\nimport { REPORT_BOOKED_CNPJ } from \"common/model/Notification\";\r\nimport { REPORT_CPF_DRIVER } from \"common/model/Notification\";\r\nimport { FISCAL_ACTION_AUDITORS } from \"common/model/Notification\";\r\nimport { HOMOLOGATION_AUDITOR } from \"common/model/Notification\";\r\nimport { INT } from \"axios/AxiosUtils\";\r\nimport { GREATER } from \"axios/AxiosUtils\";\r\nimport { CHAR } from \"axios/AxiosUtils\";\r\nimport { EQUAL } from \"axios/AxiosUtils\";\r\nimport { FISCAL_ACTION_REPORT } from \"common/model/Notification\";\r\nimport { FISCAL_ACTION_DATE } from \"common/model/Notification\";\r\nimport { FISCAL_ACTION_REPORT_DATE } from \"common/model/Notification\";\r\nimport { DESIGNATION_AUDITOR } from \"common/model/Notification\";\r\nimport { MONITORING_USER_LOGIN } from \"common/model/Notification\";\r\nimport { DESIGNATION_DATE } from \"common/model/Notification\";\r\nimport { FISCAL_ACTION_REPORT_AUDITOR } from \"common/model/Notification\";\r\nimport { AWARENESS_AUDITOR } from \"common/model/Notification\";\r\nimport { REPORT_AI } from \"common/model/Notification\";\r\nimport { REPORT_DAR } from \"common/model/Notification\";\r\nimport { REPORT_REVENUE_CODE } from \"common/model/Notification\";\r\nimport { REPORT_PENALTY_VALUE } from \"common/model/Notification\";\r\nimport { TRAILER_PLATE } from \"common/model/Notification\";\r\nimport { REPORT_BOOKED_IE } from \"common/model/Notification\";\r\nimport { REPORT_LATITUDE } from \"common/model/Notification\";\r\nimport { REPORT_LONGITUDE } from \"common/model/Notification\";\r\nimport { REPORT_PRODUCT_NAME } from \"common/model/Notification\";\r\nimport { wasSuccessRequest } from \"common/utils/errorTreatment\";\r\n\r\n\r\n\r\n\r\nexport default function NotificationModal({ show, toggle, data, initialReadOnlyState, refresh }) {\r\n\r\n  const [tabIndex, setTabIndex] = React.useState(1)\r\n  const [isFirst, setIsFirst] = React.useState(true);\r\n  const { getAuditorRegistry } = React.useContext(AuditorsContext);\r\n  const { getGroupOwnerData, getGroupSupervisorData, getMonitoringGroupOwner } = React.useContext(GroupsContext);\r\n  const { warningsViewed } = React.useContext(WarningsUpdateContext)\r\n\r\n  const [formData, setFormData] = React.useState(() => (data))\r\n  const [oldFormData] = React.useState(() => (JSON.parse(JSON.stringify(data))))\r\n  const [spinner, setSpinner] = React.useState(false)\r\n  const [invalid, setInvalid] = React.useState(false)\r\n  const [readOnly, setReadOnly] = React.useState(initialReadOnlyState)\r\n  const [mode, setMode] = React.useState({\r\n    awareness: false,\r\n    homologation: false,\r\n    supervision: false,\r\n    edition: false\r\n  })\r\n\r\n\r\n  const [updateAuditorsResponsibleFlag, toggleUpdateAuditorsResponsible] = useToggle(false)\r\n  const [imagesToUpload, setImagesToUpload] = React.useState({ 'previews': [], 'images': [] })\r\n\r\n  const { modalData, setModalData, modalActionMethods, setModalActionMethods, isModalActive, modalType, toggleModalOn, toggleModalOff, toogleMessageModalOn, toogleConfirmationModalOn } = useModalWithData()\r\n  const { mountAuditorsResponsibles } = useNotification(getAuditorRegistry, getMonitoringGroupOwner, getGroupOwnerData, getGroupSupervisorData)\r\n\r\n  const [notificationImages, setNotificationImages] = React.useState([]);\r\n\r\n  const axiosRetryProxy = axios.create(getTimeoutConfig())\r\n  axiosRetry(axiosRetryProxy, getRetryConfig())\r\n\r\n  React.useEffect(() => {\r\n    if (data) {\r\n      if (data[REPORT_BOOKED_CPF]) data[REPORT_BOOKED_CPF] = cpfFilter.mask.encode(data[REPORT_BOOKED_CPF])\r\n      if (data[REPORT_BOOKED_CNPJ]) data[REPORT_BOOKED_CNPJ] = cnpjFilter.mask.encode(data[REPORT_BOOKED_CNPJ])\r\n      if (data[REPORT_CPF_DRIVER]) data[REPORT_CPF_DRIVER] = cpfFilter.mask.encode(data[REPORT_CPF_DRIVER])\r\n    }\r\n\r\n    setFormData(data)\r\n\r\n  }, [data])\r\n\r\n\r\n  React.useEffect(() => {\r\n\r\n    let httpRequestBody = createBaseHttpRequestBody()\r\n\r\n    httpRequestBody[NOTIFICATION_ID] = data[FISCAL_NOTIFICATION_PARENT_ID]\r\n\r\n    axiosRetryProxy.post(`${env.apiAddress}/warning_images/download`, httpRequestBody)\r\n      .then(res => {\r\n\r\n        let data = res.data.map((image) => {\r\n\r\n          return { ...image, preview: image.preview ? image.preview : \"\" }\r\n        })\r\n\r\n        setNotificationImages(data)\r\n\r\n      }).catch(err => {\r\n        console.log('error ao receber imagens:', err)\r\n      })\r\n\r\n\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [])\r\n\r\n\r\n  React.useEffect(() => {\r\n    //Este método abaixo só deve ser chamado quando houver edição dos fiscais responsáveis pela ação fiscal \r\n    if (!isFirst) {\r\n\r\n      let newData = mountAuditorsResponsibles(formData)\r\n      \r\n      setFormData({ ...newData })\r\n    } else {\r\n      setIsFirst(false)\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps  \r\n  }, [updateAuditorsResponsibleFlag])\r\n\r\n  const cleanInputs = () => {\r\n\r\n    setFormData({ ...BLANK_NOTIFICATION_FORM_DATA, [FISCAL_ACTION_AUDITORS]: {}, [HOMOLOGATION_AUDITOR]: \"\" })\r\n  }\r\n\r\n\r\n\r\n\r\n  function redirectHistory() {\r\n    window.open('/notification_history', '_blank');\r\n  };\r\n\r\n\r\n\r\n\r\n  const removeImageToUpload = (index) => {\r\n\r\n    setImagesToUpload((prevState) => ({\r\n      previews: prevState.previews.filter((_, i) => i !== index),\r\n      images: prevState.images.filter((_, i) => i !== index)\r\n    }));\r\n\r\n  };\r\n\r\n  function enableEditionButton(status) {\r\n    if (isHomologated(status) || status === NOTIFICATION_STATUS_ENUM.SEM_COMANDO_HOMOLOGADA) {\r\n      return false\r\n    }\r\n    return true\r\n  }\r\n\r\n  const addImageToUpload = (event) => {\r\n    const images = event.target.files;\r\n    const imagesArray = Array.from(images);\r\n\r\n    setImagesToUpload((prevState) => ({ ...prevState, images: [...prevState.images, ...imagesArray] }))\r\n\r\n    const readerPromises = imagesArray.map((image) => {\r\n      return new Promise((resolve) => {\r\n        const reader = new FileReader();\r\n        reader.onload = () => {\r\n          resolve(compressImage(reader.result));\r\n        };\r\n        reader.readAsDataURL(image);\r\n      });\r\n    });\r\n\r\n    Promise.all(readerPromises).then((results) => {\r\n      setImagesToUpload((prevState) => ({ ...prevState, previews: [...prevState.previews, ...results] }))\r\n    });\r\n  };\r\n\r\n\r\n  const propagateNotificationData = async (warning, httpRequestBody) => {\r\n\r\n    let status = httpRequestBody[FISCAL_NOTIFICATION_STATUS]\r\n    delete httpRequestBody[FISCAL_NOTIFICATION_MODIFICATION_DATE]\r\n    httpRequestBody[FISCAL_NOTIFICATION_STATUS] = status * NOTIFICATION_STATUS_ENUM.IMPORTED_STATUS_CODE\r\n\r\n\r\n    let filters = []\r\n    filters.push(createSimpleFilterClause(VEHICLE_PLATE, CHAR, EQUAL, warning[VEHICLE_PLATE]))\r\n    filters.push(createSimpleFilterClause(ID_CONFIG, CHAR, EQUAL, warning[ID_CONFIG]))\r\n    filters.push(createSimpleFilterClause(ID, INT, GREATER, warning[FISCAL_NOTIFICATION_PARENT_ID]))\r\n    filters.push(createSimpleFilterClause(FISCAL_NOTIFICATION_STATUS, INT, GREATER, NOTIFICATION_STATUS_ENUM.DESIGNADA))\r\n    filters.push(createNotFilterClause(ID, INT, EQUAL, warning[ID]))\r\n\r\n    httpRequestBody[FILTERS] = filters\r\n\r\n    axios.patch(`${env.apiAddress}/warnings/update_by_filter/`, httpRequestBody)\r\n      .then(res => {\r\n        refresh();\r\n        return res\r\n      }).catch(err => {\r\n        return err\r\n      })\r\n  }\r\n\r\n\r\n  const updateNotification = async () => {\r\n\r\n    let httpRequestBody = createBaseHttpRequestBody({\r\n      [FISCAL_NOTIFICATION_PARENT_ID]: formData[FISCAL_NOTIFICATION_PARENT_ID],\r\n      [FISCAL_ACTION_AUDITORS]: formatFiscalAuditors(Object.values(formData[FISCAL_ACTION_AUDITORS])),\r\n      [FISCAL_ACTION_REPORT]: escapeSpecialCharacters(formData[FISCAL_ACTION_REPORT]),\r\n      [FISCAL_ACTION_DATE]: `${formData[FISCAL_ACTION_DATE][0]}T${formData[FISCAL_ACTION_DATE][1]}`,\r\n      [FISCAL_ACTION_REPORT_DATE]: getNowDateTimeString(),\r\n      [FISCAL_NOTIFICATION_MODIFICATION_DATE]: getNowDateTimeString(),\r\n      [DESIGNATION_AUDITOR]: formData[MONITORING_USER_LOGIN],\r\n      [DESIGNATION_DATE]: formData[DESIGNATION_DATE],\r\n      [FISCAL_ACTION_REPORT_AUDITOR]: getUserLogin(),\r\n      [HOMOLOGATION_AUDITOR]: formData[HOMOLOGATION_AUDITOR],\r\n      [AWARENESS_AUDITOR]: formData[AWARENESS_AUDITOR],\r\n      [REPORT_ENABLED]: formData[REPORT_ENABLED],\r\n      [REPORT_AI]: escapeSpecialCharacters(removeUnicode(formData[REPORT_AI])),\r\n      [REPORT_DAR]: escapeSpecialCharacters(removeUnicode(formData[REPORT_DAR])),\r\n      [REPORT_REVENUE_CODE]: escapeSpecialCharacters(removeUnicode(formData[REPORT_REVENUE_CODE])),\r\n      [REPORT_PENALTY_VALUE]: removeMask(removeUnicode(formData[REPORT_PENALTY_VALUE]), MASK_ENUM.MONEY),\r\n      [TRAILER_PLATE]: escapeSpecialCharacters(removeUnicode(formData[TRAILER_PLATE])),\r\n      [VEHICLE_PLATE]: escapeSpecialCharacters(removeUnicode(formData[VEHICLE_PLATE])),\r\n      [REPORT_CPF_DRIVER]: escapeSpecialCharacters(removeMask(formData[REPORT_CPF_DRIVER])),\r\n      [REPORT_BOOKED_IE]: escapeSpecialCharacters(removeUnicode(formData[REPORT_BOOKED_IE])),\r\n      [REPORT_BOOKED_CPF]: escapeSpecialCharacters(removeMask(formData[REPORT_BOOKED_CPF])),\r\n      [REPORT_BOOKED_CNPJ]: escapeSpecialCharacters(removeMask(formData[REPORT_BOOKED_CNPJ])),\r\n      [REPORT_LATITUDE]: treatNullValue(removeUnicode(formData[REPORT_LATITUDE]), 0.0),\r\n      [REPORT_LONGITUDE]: treatNullValue(removeUnicode(formData[REPORT_LONGITUDE]), 0.0),\r\n      [REPORT_PRODUCT_NAME]: escapeSpecialCharacters(formData[REPORT_PRODUCT_NAME])\r\n    })\r\n\r\n    let newStatus = evaluateStatus(httpRequestBody, formData[FISCAL_NOTIFICATION_STATUS])\r\n    httpRequestBody[FISCAL_NOTIFICATION_STATUS] = newStatus\r\n\r\n\r\n\r\n    return await axios.patch(`${env.apiAddress}/warnings/update/${formData[ID]}`, httpRequestBody)\r\n      .then(async res => {\r\n\r\n        if (wasSuccessRequest(res, ID)) {\r\n          setFormData({ ...formData, [FISCAL_NOTIFICATION_STATUS]: newStatus })\r\n\r\n          if (alowPropagateNotificationData(formData)) {\r\n            await propagateNotificationData(formData, httpRequestBody)\r\n          }\r\n        }\r\n        return res\r\n      }).catch(err => {\r\n        return err\r\n      })\r\n  }\r\n\r\n  const uploadImage = async (image) => {\r\n\r\n    let httpRequestBody = createBaseHttpRequestBody()\r\n\r\n    httpRequestBody[NOTIFICATION_ID] = formData[FISCAL_NOTIFICATION_PARENT_ID]\r\n    httpRequestBody[IMAGE_DESCRIPTION] = image[IMAGE_NAME]\r\n\r\n    const base64String = await readFileAsBase64(image, false);\r\n\r\n    httpRequestBody[IMAGE_DATA] = base64String.replace(/^data:image\\/(png|jpeg);base64,/, '');\r\n    httpRequestBody[IMAGE_PREVIEW] = base64String\r\n\r\n    if (httpRequestBody[IMAGE_DESCRIPTION] && httpRequestBody[IMAGE_DESCRIPTION].includes(\"derzu\")) {\r\n      console.log(\"DERZU1\", base64String.length)\r\n      console.log(\"DERZU2\", base64String)\r\n      console.log(\"DERZU3\", httpRequestBody['image_data'].length)\r\n      console.log(\"DERZU4\", httpRequestBody['image_data'])\r\n    }\r\n\r\n    try {\r\n      let res = await axios.post(`${env.apiAddress}/warning_images/upload`, httpRequestBody);\r\n      //resolve();\r\n      return res\r\n    } catch (err) {\r\n      //reject()\r\n      console.log(err)\r\n      return err\r\n    }\r\n  }\r\n\r\n  const update = async (mode) => {\r\n    setSpinner(true)\r\n    toggleModalOn(MODAL_TYPE_ENUM.MESSAGE)\r\n\r\n    let promisses = []\r\n\r\n    if (mode === DATA_ONLY || mode === MERGE) {\r\n      promisses.push(updateNotification())\r\n    }\r\n\r\n    if (mode === IMAGE_ONLY || mode === MERGE) {\r\n      for (const image of imagesToUpload.images) {\r\n        let imagePromisse = uploadImage(image)\r\n        promisses.push(imagePromisse)\r\n      }\r\n    }\r\n\r\n    try {\r\n      let responses = await Promise.all(promisses);\r\n      let data = formatCompletionData(mode, responses)\r\n\r\n      refresh();\r\n      toogleMessageModalOn(data.message, data.icon)\r\n\r\n    } catch (error) {\r\n      console.log(error)\r\n      toogleMessageModalOn(\"Falha na atualização da Notificação!\", ERROR)\r\n    } finally {\r\n      setMode({ ...mode, edition: false })\r\n      setSpinner(false)\r\n    }\r\n  }\r\n\r\n  const deleteImage = async (imageIndex) => {\r\n\r\n    const entity = \"da Imagem\"\r\n\r\n    let httpRequestBody = createBaseHttpRequestBody()\r\n\r\n    httpRequestBody[NOTIFICATION_ID] = formData[FISCAL_NOTIFICATION_PARENT_ID]\r\n    httpRequestBody[ID_IMAGE] = notificationImages[imageIndex][ID_IMAGE]\r\n\r\n    axios.post(`${env.apiAddress}/warning_images/delete`, httpRequestBody).then(res => {\r\n      treatResponse(entity, EXCLUSION, ID_IMAGE, res, setModalData, refresh)\r\n    }).catch(err => {\r\n      setModalData(treatError(err, entity, EXCLUSION));\r\n    }).finally(() => {\r\n      setSpinner(false)\r\n      cleanInputs()\r\n    })\r\n\r\n  }\r\n\r\n\r\n  const openDeleteConfirmationModal = (imageIndex) => {\r\n    setModalActionMethods([undefined, undefined, deleteImage]);\r\n    setModalData({ message: 'Confima a exclusão desta imagem?', operation: EXCLUSION, id: imageIndex })\r\n    toggleModalOn(MODAL_TYPE_ENUM.CONFIRMATION)\r\n  };\r\n\r\n\r\n\r\n  const openConfirmationModal = () => {\r\n    let errorMessages = validateData(formData)\r\n\r\n    if (hasEmptyValues(formData)) {\r\n      setInvalid(true)\r\n      toogleMessageModalOn(\"Há campos obrigatórios não preenchidos!\", ERROR)\r\n\r\n    } else if (!isEmpty(errorMessages)) {\r\n      setInvalid(true)\r\n      let errorMessage = \"Há campos obrigatórios com dados inválidos:\\n\"\r\n      errorMessage += errorMessages.join(\"\")\r\n      toogleMessageModalOn(errorMessage, ERROR)\r\n\r\n    } else {\r\n\r\n      let hasImageModification = (imagesToUpload.images.length > 0)\r\n      let hasDataModification = !compareWithOldValues(formData, oldFormData)\r\n\r\n      let mode = (hasDataModification) ? DATA_ONLY : NOTHING\r\n      mode = (!hasDataModification && hasImageModification) ? IMAGE_ONLY : mode\r\n      mode = (hasDataModification && hasImageModification) ? MERGE : mode\r\n\r\n      setInvalid(false)\r\n      if (mode === NOTHING) {\r\n        let errorMessage = \"Não há alterações a serem salvas para esta notificação!\"\r\n        toogleMessageModalOn(errorMessage, ERROR)\r\n      } else {\r\n        let message = formatConfirmationMessage(mode)\r\n        let data = { message: message, operation: EDITION, id: formData[ID] }\r\n        toogleConfirmationModalOn(data, () => { setSpinner(true); update(mode, formData[ID]); setReadOnly(true) })\r\n      }\r\n    }\r\n  }\r\n\r\n  const getTabPaneNames = () => {\r\n    if (isEmpty(formData[SUPERVISION_AUDITOR])) {\r\n      return DEFAULT_TAB_PANE_NAMES\r\n    } else {\r\n      return TAB_PANE_NAME_WITH_SUPERVISION\r\n    }\r\n  }\r\n\r\n\r\n  const EditionButton = () => {\r\n\r\n    return <Row>\r\n      {enableEditionButton(formData[FISCAL_NOTIFICATION_STATUS]) &&\r\n        <Col style={{ textAlign: \"end\", marginTop: \"10px\" }}>\r\n          {readOnly ?\r\n            <Button color='primary'\r\n              onClick={() => { setReadOnly(false); setTabIndex(3); setMode({ ...mode, edition: true }) }}\r\n              style={{ width: \"12rem\", height: \"2.5rem\", marginTop: \"10px\" }}>Editar Ação Fiscal\r\n            </Button>\r\n            :\r\n            <>\r\n              <Button\r\n                color='primary'\r\n                onClick={() => {\r\n                  openConfirmationModal();\r\n                }}\r\n                style={{ marginRight: \"1rem\", marginTop: \"10px\" }}\r\n              >\r\n                Salvar\r\n              </Button>\r\n              <Button\r\n                color='danger'\r\n                style={{ marginTop: \"10px\" }}\r\n                onClick={() => { setFormData(JSON.parse(JSON.stringify(oldFormData))); setMode({ ...mode, edition: false }); setReadOnly(true); }}\r\n              >\r\n                Cancelar\r\n              </Button>\r\n            </>\r\n          }\r\n        </Col>\r\n      }\r\n    </Row>\r\n\r\n\r\n  }\r\n\r\n\r\n  const BuildNavigationPart = () => {\r\n\r\n    return (\r\n      <Nav tabs style={{ background: \"#f2f2f2\" }}>\r\n        {\r\n          Object.entries(getTabPaneNames()).map((key_value) => {\r\n            return (\r\n              <NavItem key={key_value[0]} style={{ cursor: \"pointer\" }}>\r\n                <NavLink\r\n                  className={tabIndex === (key_value[1]) ? \"active\" : \"\"}\r\n                  style={formatTabBackground(mode, key_value[1])}\r\n                  onClick={() => { setTabIndex(key_value[1]) }}\r\n                  key={key_value[0]}\r\n                >\r\n                  {formatTabNames(mode, key_value[1], key_value[0])}\r\n                </NavLink>\r\n              </NavItem>\r\n            )\r\n          })\r\n        }\r\n      </Nav>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Modal isOpen={show} toggle={toggle} size=\"lg\">\r\n        <ModalHeader toggle={toggle} style={{ padding: \"10px 15px\" }}>\r\n          {`${formData[NAME]} (Ocorrência ${formData[ID]}) - ${getNotificationMostRecentStatus(formData[ID], formData[FISCAL_NOTIFICATION_STATUS], warningsViewed)}`}\r\n        </ModalHeader>\r\n        <ModalBody style={{ alignContent: 'center', padding: \"0px\" }}>\r\n          <BuildNavigationPart />\r\n          <TabContent activeTab={`${tabIndex}`} style={{ padding: \"15px\" }}>\r\n            <TabPane tabId=\"1\">\r\n\r\n              <EventPanel data={formData} />\r\n\r\n            </TabPane>\r\n\r\n            <TabPane tabId=\"2\">\r\n\r\n              <DesignationPanel data={formData} />\r\n\r\n              <HomologationPanel data={formData} setData={setFormData} refresh={refresh} homologationType={AWARENESS_MODE} setMode={setMode} mode={mode} />\r\n\r\n            </TabPane>\r\n\r\n            <TabPane tabId=\"3\">\r\n\r\n              <FiscalActionPanel data={formData} setData={setFormData} oldData={oldFormData} readOnly={readOnly} invalid={invalid} refresh={toggleUpdateAuditorsResponsible} />\r\n\r\n              <EditionButton />\r\n\r\n            </TabPane>\r\n\r\n            <TabPane tabId=\"4\">\r\n              <ReportPanel data={formData} setData={setFormData} oldData={oldFormData} invalid={invalid} readOnly={readOnly} />\r\n\r\n              <EditionButton />\r\n            </TabPane>\r\n\r\n            {tabIndex === 5 &&\r\n              <TabPane tabId=\"5\">\r\n                {!imagesToUpload.previews.length && notificationImages.length === 0 && emptyBackground}\r\n                <Row style={{ display: 'flex', flexWrap: 'wrap', padding: '10px', maxWidth: '100%', overflowX: 'auto', margin: '0' }}>\r\n                  {notificationImages.map((notificationImg, index) => (\r\n                    <Col md=\"4\" xs=\"4\" key={index} style={{ margin: '0px 0px 15px 0px' }}>\r\n                      <img src={notificationImg[IMAGE_PREVIEW]} alt={`Preview2 ${index}`} style={{ margin: '0px 0px 0px 5px' }} />\r\n                      <a href={`${notificationImg[IMAGE_URL]}`}>\r\n                        <BsArrowDownCircleFill style={{ color: 'green', fontSize: '20px', position: 'absolute', top: '20px', right: '1px', cursor: 'pointer' }} />\r\n                      </a>\r\n                      {!readOnly && <BsFillXCircleFill onClick={() => openDeleteConfirmationModal(index)} style={{ color: '#EF8157', fontSize: '20px', position: 'absolute', top: '-1px', right: '1px', cursor: 'pointer' }} />}\r\n                    </Col>\r\n                  ))}\r\n                  {imagesToUpload.previews.map((previewImg, index) => (\r\n                    <Col md=\"4\" xs=\"4\" key={index} style={{ margin: '0px 0px 15px 0px' }}>\r\n                      <img src={previewImg} alt={`Preview ${index}`} style={{ maxWidth: '100%', margin: '5px', position: 'relative' }} />\r\n                      {!readOnly && <BsFillXCircleFill onClick={() => removeImageToUpload(index)} style={{ color: '#EF8157', fontSize: '20px', position: 'absolute', top: '-1px', right: '1px', cursor: 'pointer' }} />}\r\n                    </Col>\r\n                  ))}\r\n                </Row>\r\n                <Row>\r\n                  <Col style={{ textAlign: \"center\" }}>\r\n                    <label htmlFor=\"file-upload\" readOnly={readOnly} disabled={readOnly} className=\"custom-file-upload btn btn-primary\" style={{ marginTop: '65px', marginBottom: '49px' }}>\r\n                      <input\r\n                        id=\"file-upload\"\r\n                        type=\"file\"\r\n                        multiple\r\n                        readOnly={readOnly}\r\n                        disabled={readOnly}\r\n                        accept=\"image/png,image/jpeg\"\r\n                        onChange={addImageToUpload}\r\n                        style={{ display: 'none' }}\r\n                      />\r\n                      Selecionar Imagens\r\n                    </label>\r\n                  </Col>\r\n                </Row>\r\n\r\n                <EditionButton />\r\n\r\n              </TabPane>\r\n            }\r\n\r\n            <TabPane tabId=\"6\">\r\n              <HomologationPanel data={formData} setData={setFormData} refresh={refresh} homologationType={SUPERVISION_MODE} setMode={setMode} mode={mode} />\r\n            </TabPane>\r\n\r\n            <TabPane tabId=\"7\">\r\n              <HomologationPanel data={formData} setData={setFormData} refresh={refresh} homologationType={HOMOLOGATION_MODE} setMode={setMode} mode={mode} />\r\n            </TabPane>\r\n\r\n            <TabPane tabId=\"8\">\r\n              <Row style={{ marginTop: '5px' }}>\r\n                <Col>\r\n                  <b>Histórico (<a style={{ color: \"#51cbce\", cursor: \"pointer\" }} onClick={() => { redirectHistory(); }}>Versão Completa</a>):</b>\r\n                  <Input\r\n                    type='textarea'\r\n                    value={formData[HISTORY]}\r\n                    readOnly\r\n                    maxLength=\"2048\"\r\n                    style={{ minHeight: \"21em\", padding: \"6px 7px 6px 12px\" }}\r\n                  />\r\n                </Col>\r\n              </Row>\r\n            </TabPane>\r\n          </TabContent>\r\n\r\n        </ModalBody>\r\n      </Modal>\r\n\r\n      {modalType === MODAL_TYPE_ENUM.CONFIRMATION && <ConfirmationModal show={isModalActive} toggle={toggleModalOff} data={modalData} actionMethods={modalActionMethods} />}\r\n      {modalType === MODAL_TYPE_ENUM.MESSAGE && <MessageModal show={isModalActive} toggle={toggleModalOff} data={modalData} spinner={spinner} />}\r\n\r\n    </>)\r\n}"]},"metadata":{},"sourceType":"module"}